<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>View Controller Definition åŒè¯­ | Hippo â˜ï¸</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/static_page/logo.png">
    <meta name="description" content="è®°å½•ä¸€äº›ä¸œè¥¿">
    
    <link rel="preload" href="/static_page/assets/css/0.styles.01b3f448.css" as="style"><link rel="preload" href="/static_page/assets/js/app.ecc8d6d4.js" as="script"><link rel="preload" href="/static_page/assets/js/2.6f374f29.js" as="script"><link rel="preload" href="/static_page/assets/js/9.c45e563a.js" as="script"><link rel="prefetch" href="/static_page/assets/js/10.f7a9db1e.js"><link rel="prefetch" href="/static_page/assets/js/11.655481c7.js"><link rel="prefetch" href="/static_page/assets/js/12.bbf336b7.js"><link rel="prefetch" href="/static_page/assets/js/13.8bd37448.js"><link rel="prefetch" href="/static_page/assets/js/14.bea6ccee.js"><link rel="prefetch" href="/static_page/assets/js/15.e6066554.js"><link rel="prefetch" href="/static_page/assets/js/16.54101596.js"><link rel="prefetch" href="/static_page/assets/js/17.bf1cfb60.js"><link rel="prefetch" href="/static_page/assets/js/18.cb3ed05a.js"><link rel="prefetch" href="/static_page/assets/js/19.e1d13bfd.js"><link rel="prefetch" href="/static_page/assets/js/20.865950b7.js"><link rel="prefetch" href="/static_page/assets/js/21.5dfc2f03.js"><link rel="prefetch" href="/static_page/assets/js/22.7f31943a.js"><link rel="prefetch" href="/static_page/assets/js/23.09aac35b.js"><link rel="prefetch" href="/static_page/assets/js/24.072f13df.js"><link rel="prefetch" href="/static_page/assets/js/25.756282c1.js"><link rel="prefetch" href="/static_page/assets/js/26.8061202e.js"><link rel="prefetch" href="/static_page/assets/js/27.270a0a92.js"><link rel="prefetch" href="/static_page/assets/js/28.017dc8cc.js"><link rel="prefetch" href="/static_page/assets/js/29.f1b22196.js"><link rel="prefetch" href="/static_page/assets/js/3.7099dd68.js"><link rel="prefetch" href="/static_page/assets/js/30.7d37bb5a.js"><link rel="prefetch" href="/static_page/assets/js/31.0186a17b.js"><link rel="prefetch" href="/static_page/assets/js/32.5dd05710.js"><link rel="prefetch" href="/static_page/assets/js/33.46ad45ad.js"><link rel="prefetch" href="/static_page/assets/js/34.82938be2.js"><link rel="prefetch" href="/static_page/assets/js/35.96d2028c.js"><link rel="prefetch" href="/static_page/assets/js/36.e274121f.js"><link rel="prefetch" href="/static_page/assets/js/37.278f5c7f.js"><link rel="prefetch" href="/static_page/assets/js/38.fcb88521.js"><link rel="prefetch" href="/static_page/assets/js/39.aeced8c4.js"><link rel="prefetch" href="/static_page/assets/js/4.22ef053b.js"><link rel="prefetch" href="/static_page/assets/js/40.f9448ab4.js"><link rel="prefetch" href="/static_page/assets/js/5.a4d6a358.js"><link rel="prefetch" href="/static_page/assets/js/6.acc5f195.js"><link rel="prefetch" href="/static_page/assets/js/7.7d458c87.js"><link rel="prefetch" href="/static_page/assets/js/8.57594a85.js">
    <link rel="stylesheet" href="/static_page/assets/css/0.styles.01b3f448.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/static_page/" class="home-link router-link-active"><img src="/static_page/logo.png" alt="Hippo â˜ï¸" class="logo"> <span class="site-name can-hide">Hippo â˜ï¸</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/static_page/" class="nav-link">
  Home ğŸ 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="iOS ğŸ" class="dropdown-title"><span class="title">iOS ğŸ</span> <span class="arrow down"></span></button> <button type="button" aria-label="iOS ğŸ" class="mobile-dropdown-title"><span class="title">iOS ğŸ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/iOS/" class="nav-link">
  iOS
</a></li><li class="dropdown-item"><h4>
          ç¿»è¯‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/iOS/UIImageViewç¿»è¯‘.html" class="nav-link">
  UIImageView ç¿»è¯‘
</a></li><li class="dropdown-subitem"><a href="/static_page/PG-ViewController/" class="nav-link router-link-active">
  PG-ViewController ç¿»è¯‘
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Technology ğŸŒŸ" class="dropdown-title"><span class="title">Technology ğŸŒŸ</span> <span class="arrow down"></span></button> <button type="button" aria-label="Technology ğŸŒŸ" class="mobile-dropdown-title"><span class="title">Technology ğŸŒŸ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/Technology/" class="nav-link">
  Technology
</a></li><li class="dropdown-item"><h4>
          Projects
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Technology/iOS-Demo.html" class="nav-link">
  iOS-Demo
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Philosophy ğŸ¤”" class="dropdown-title"><span class="title">Philosophy ğŸ¤”</span> <span class="arrow down"></span></button> <button type="button" aria-label="Philosophy ğŸ¤”" class="mobile-dropdown-title"><span class="title">Philosophy ğŸ¤”</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/Philosophy/" class="nav-link">
  Philosophy
</a></li><li class="dropdown-item"><h4>
          é˜…è¯»ç¬”è®°
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Philosophy/å®‹æ˜ç†å­¦15è®².html" class="nav-link">
  å®‹æ˜ç†å­¦15è®²
</a></li><li class="dropdown-subitem"><a href="/static_page/Philosophy/æ–°æ•™ä¼¦ç†ä¸èµ„æœ¬ä¸»ä¹‰ç²¾ç¥.html" class="nav-link">
  æ–°æ•™ä¼¦ç†ä¸èµ„æœ¬ä¸»ä¹‰ç²¾ç¥
</a></li><li class="dropdown-subitem"><a href="/static_page/Philosophy/åŸºç£æ•™æ•…äº‹ååˆ™ä¸ç›¸å…³è‰ºæœ¯ä½œå“.html" class="nav-link">
  åŸºç£æ•™æ•…äº‹ååˆ™ä¸ç›¸å…³è‰ºæœ¯ä½œå“
</a></li></ul></li><li class="dropdown-item"><h4>
          æˆ‘çš„æƒ³æ³•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Philosophy/è§£é‡Šä¸–ç•Œ.html" class="nav-link">
  è§£é‡Šä¸–ç•Œ
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others ğŸ˜Š" class="dropdown-title"><span class="title">Others ğŸ˜Š</span> <span class="arrow down"></span></button> <button type="button" aria-label="Others ğŸ˜Š" class="mobile-dropdown-title"><span class="title">Others ğŸ˜Š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/Others/" class="nav-link">
  Others
</a></li><li class="dropdown-item"><!----> <a href="/static_page/Others/æ›´æ–°éƒ¨ç½².html" class="nav-link">
  æ›´æ–°éƒ¨ç½²
</a></li><li class="dropdown-item"><h4>
          è®°å½•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Others/Memory.html" class="nav-link">
  Memory
</a></li><li class="dropdown-subitem"><a href="/static_page/Others/è§‚å½±è®°å½•.html" class="nav-link">
  è§‚å½±è®°å½•
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/butub1/static_page" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/static_page/" class="nav-link">
  Home ğŸ 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="iOS ğŸ" class="dropdown-title"><span class="title">iOS ğŸ</span> <span class="arrow down"></span></button> <button type="button" aria-label="iOS ğŸ" class="mobile-dropdown-title"><span class="title">iOS ğŸ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/iOS/" class="nav-link">
  iOS
</a></li><li class="dropdown-item"><h4>
          ç¿»è¯‘
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/iOS/UIImageViewç¿»è¯‘.html" class="nav-link">
  UIImageView ç¿»è¯‘
</a></li><li class="dropdown-subitem"><a href="/static_page/PG-ViewController/" class="nav-link router-link-active">
  PG-ViewController ç¿»è¯‘
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Technology ğŸŒŸ" class="dropdown-title"><span class="title">Technology ğŸŒŸ</span> <span class="arrow down"></span></button> <button type="button" aria-label="Technology ğŸŒŸ" class="mobile-dropdown-title"><span class="title">Technology ğŸŒŸ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/Technology/" class="nav-link">
  Technology
</a></li><li class="dropdown-item"><h4>
          Projects
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Technology/iOS-Demo.html" class="nav-link">
  iOS-Demo
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Philosophy ğŸ¤”" class="dropdown-title"><span class="title">Philosophy ğŸ¤”</span> <span class="arrow down"></span></button> <button type="button" aria-label="Philosophy ğŸ¤”" class="mobile-dropdown-title"><span class="title">Philosophy ğŸ¤”</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/Philosophy/" class="nav-link">
  Philosophy
</a></li><li class="dropdown-item"><h4>
          é˜…è¯»ç¬”è®°
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Philosophy/å®‹æ˜ç†å­¦15è®².html" class="nav-link">
  å®‹æ˜ç†å­¦15è®²
</a></li><li class="dropdown-subitem"><a href="/static_page/Philosophy/æ–°æ•™ä¼¦ç†ä¸èµ„æœ¬ä¸»ä¹‰ç²¾ç¥.html" class="nav-link">
  æ–°æ•™ä¼¦ç†ä¸èµ„æœ¬ä¸»ä¹‰ç²¾ç¥
</a></li><li class="dropdown-subitem"><a href="/static_page/Philosophy/åŸºç£æ•™æ•…äº‹ååˆ™ä¸ç›¸å…³è‰ºæœ¯ä½œå“.html" class="nav-link">
  åŸºç£æ•™æ•…äº‹ååˆ™ä¸ç›¸å…³è‰ºæœ¯ä½œå“
</a></li></ul></li><li class="dropdown-item"><h4>
          æˆ‘çš„æƒ³æ³•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Philosophy/è§£é‡Šä¸–ç•Œ.html" class="nav-link">
  è§£é‡Šä¸–ç•Œ
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others ğŸ˜Š" class="dropdown-title"><span class="title">Others ğŸ˜Š</span> <span class="arrow down"></span></button> <button type="button" aria-label="Others ğŸ˜Š" class="mobile-dropdown-title"><span class="title">Others ğŸ˜Š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/static_page/Others/" class="nav-link">
  Others
</a></li><li class="dropdown-item"><!----> <a href="/static_page/Others/æ›´æ–°éƒ¨ç½².html" class="nav-link">
  æ›´æ–°éƒ¨ç½²
</a></li><li class="dropdown-item"><h4>
          è®°å½•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/static_page/Others/Memory.html" class="nav-link">
  Memory
</a></li><li class="dropdown-subitem"><a href="/static_page/Others/è§‚å½±è®°å½•.html" class="nav-link">
  è§‚å½±è®°å½•
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/butub1/static_page" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/static_page/iOS/" class="sidebar-link">iOS</a></li><li><a href="/static_page/PG-ViewController/" aria-current="page" class="sidebar-link">ç¿»è¯‘ ğŸ” View Controller Programming Guide for iOS</a></li><li><a href="/static_page/PG-ViewController/Overview.html" class="sidebar-link">ä¸€. æ¦‚è¿° ğŸŸ Overview</a></li><li><a href="/static_page/PG-ViewController/ViewControllerDefinition.html" class="sidebar-link">äºŒ. å®šä¹‰VC ğŸŸ View Controller Definition</a></li><li><a href="/static_page/PG-ViewController/PresentationAndTransitions.html" class="sidebar-link">ä¸‰. å‘ˆç°ä¸è½¬åœº ğŸŸ Presentations and Transitions</a></li><li><a href="/static_page/PG-ViewController/AdaptivityAndSizeChanges.html" class="sidebar-link">å››. è‡ªé€‚åº”å’Œsizeå˜åŒ– ğŸŸ Adaptivity And Size Changes</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="view-controller-definition-åŒè¯­"><a href="#view-controller-definition-åŒè¯­" class="header-anchor">#</a> View Controller Definition åŒè¯­</h1> <p></p><div class="table-of-contents"><ul><li><a href="#view-controller-definition-åŒè¯­">View Controller Definition åŒè¯­</a><ul><li><a href="#_1-å®šä¹‰ä½ çš„å­ç±»-ğŸŸ-define-your-subclass">1. å®šä¹‰ä½ çš„å­ç±» ğŸŸ   define your subclass</a><ul><li><a href="#å®šä¹‰æ‚¨çš„ui-ğŸŸ-defining-your-ui">å®šä¹‰æ‚¨çš„UI ğŸŸ Defining Your UI</a></li><li><a href="#å¤„ç†ç”¨æˆ·äº¤äº’-ğŸŸ-handling-user-interactions">å¤„ç†ç”¨æˆ·äº¤äº’ ğŸŸ Handling User Interactions</a></li><li><a href="#åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºæ‚¨çš„è§†å›¾-ğŸŸ-displaying-your-views-at-runtime">åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºæ‚¨çš„è§†å›¾ ğŸŸ Displaying Your Views at Runtime</a></li><li><a href="#ç®¡ç†è§†å›¾å¸ƒå±€-ğŸŸ-managing-view-layout">ç®¡ç†è§†å›¾å¸ƒå±€ ğŸŸ Managing View Layout</a></li><li><a href="#æœ‰æ•ˆç®¡ç†å†…å­˜-ğŸŸ-managing-memory-efficiently">æœ‰æ•ˆç®¡ç†å†…å­˜ ğŸŸ Managing Memory Efficiently</a></li></ul></li><li><a href="#_2-å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-implementing-a-container-view-controller">2. å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨ ğŸŸ Implementing a Container View Controller</a><ul><li><a href="#è®¾è®¡è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-designing-a-custom-container-view-controller">è®¾è®¡è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨ ğŸŸ Designing a Custom Container View Controller</a></li><li><a href="#example-navigation-controller-ğŸŸ-example-navigation-controller">Example: Navigation Controller ğŸŸ Example: Navigation Controller</a></li><li><a href="#example-split-view-controller-ğŸŸ-example-split-view-controller">Example: Split View Controller ğŸŸ Example: Split View Controller</a></li><li><a href="#åœ¨interface-builderä¸­é…ç½®å®¹å™¨-ğŸŸ-configuring-a-container-in-interface-builder">åœ¨Interface Builderä¸­é…ç½®å®¹å™¨ ğŸŸ Configuring a Container in Interface Builder</a></li><li><a href="#å®ç°è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-implementing-a-custom-container-view-controller">å®ç°è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨ ğŸŸ Implementing a Custom Container View Controller</a></li><li><a href="#å°†å­è§†å›¾æ§åˆ¶å™¨æ·»åŠ åˆ°æ‚¨çš„å†…å®¹ä¸Š-ğŸŸ-adding-a-child-view-controller-to-your-content">å°†å­è§†å›¾æ§åˆ¶å™¨æ·»åŠ åˆ°æ‚¨çš„å†…å®¹ä¸Š ğŸŸ Adding a Child View Controller to Your Content</a></li><li><a href="#åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨-ğŸŸ-removing-a-child-view-controller">åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ ğŸŸ Removing a Child View Controller</a></li><li><a href="#å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„è½¬æ¢-ğŸŸ-transitioning-between-child-view-controllers">å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„è½¬æ¢ ğŸŸ Transitioning Between Child View Controllers</a></li><li><a href="#ç®¡ç†å­vcçš„å¤–è§‚æ›´æ–°-ğŸŸ-managing-appearance-updates-for-children">ç®¡ç†å­VCçš„å¤–è§‚æ›´æ–° ğŸŸ Managing Appearance Updates for Children</a></li><li><a href="#å…³äºæ„å»ºå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å»ºè®®-ğŸŸ-suggestions-for-building-a-container-view-controller">å…³äºæ„å»ºå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å»ºè®® ğŸŸ Suggestions for Building a Container View Controller</a></li><li><a href="#å°†æ§åˆ¶å§”æ‰˜ç»™å­è§†å›¾æ§åˆ¶å™¨-ğŸŸ-delegating-control-to-a-child-view-controller">å°†æ§åˆ¶å§”æ‰˜ç»™å­è§†å›¾æ§åˆ¶å™¨ ğŸŸ Delegating Control to a Child View Controller</a></li></ul></li><li><a href="#_3-æ”¯æŒæ— éšœç¢-ğŸŸ-supporting-accessibility">3. æ”¯æŒæ— éšœç¢ ğŸŸ Supporting Accessibility</a><ul><li><a href="#å°†-voiceover-ç”»å¤–éŸ³-å…‰æ ‡ç§»åŠ¨åˆ°ç‰¹å®šå…ƒç´ -ğŸŸ-moving-the-voiceover-cursor-to-a-specific-element">å°†VoiceOver(ç”»å¤–éŸ³)å…‰æ ‡ç§»åŠ¨åˆ°ç‰¹å®šå…ƒç´  ğŸŸ Moving the VoiceOver Cursor to a Specific Element</a></li><li><a href="#å›åº”ç‰¹å®šçš„ç”»å¤–éŸ³æ‰‹åŠ¿-ğŸŸ-responding-to-special-voiceover-gestures">å›åº”ç‰¹å®šçš„ç”»å¤–éŸ³æ‰‹åŠ¿ ğŸŸ Responding to Special VoiceOver Gestures</a></li><li><a href="#é€€å‡º-ğŸŸ-escape">é€€å‡º ğŸŸ Escape</a></li><li><a href="#ä¸¤æŒ‡åŒå‡»-ğŸŸ-magic-tap">ä¸¤æŒ‡åŒå‡» ğŸŸ Magic Tap</a></li><li><a href="#ä¸‰æŒ‡æ»šåŠ¨-ğŸŸ-three-finger-scroll">ä¸‰æŒ‡æ»šåŠ¨ ğŸŸ Three-Finger Scroll</a></li><li><a href="#å¢å¤§å’Œå‡å°-ğŸŸ-increment-and-decrement">å¢å¤§å’Œå‡å° ğŸŸ Increment and Decrement</a></li><li><a href="#ç›‘å¬æ— éšœç¢é€šçŸ¥-ğŸŸ-observing-accessibility-notifications">ç›‘å¬æ— éšœç¢é€šçŸ¥ ğŸŸ Observing Accessibility Notifications</a></li></ul></li><li><a href="#_4-ä¿å­˜å’Œæ¢å¤çŠ¶æ€-ğŸŸ-preserving-and-restoring-state">4. ä¿å­˜å’Œæ¢å¤çŠ¶æ€ ğŸŸ Preserving and Restoring State</a><ul><li><a href="#æ ‡è®°ä¿å­˜è§†å›¾æ§åˆ¶å™¨-ğŸŸ-tagging-view-controllers-for-preservation">æ ‡è®°ä¿å­˜è§†å›¾æ§åˆ¶å™¨ ğŸŸ Tagging View Controllers for Preservation</a></li><li><a href="#é€‰æ‹©æœ‰æ•ˆçš„-restorationidentifier-ğŸŸ-choosing-effective-restoration-identifiers">é€‰æ‹©æœ‰æ•ˆçš„restorationIdentifier ğŸŸ Choosing Effective Restoration Identifiers</a></li><li><a href="#æ’é™¤è§†å›¾æ§åˆ¶å™¨ç»„-ğŸŸ-excluding-groups-of-view-controllers">æ’é™¤è§†å›¾æ§åˆ¶å™¨ç»„ ğŸŸ Excluding Groups of View Controllers</a></li><li><a href="#ä¿ç•™è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾-ğŸŸ-preserving-a-view-controller-s-views">ä¿ç•™è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ ğŸŸ Preserving a View Controllerâ€™s Views</a></li><li><a href="#åœ¨å¯åŠ¨æ—¶æ¢å¤è§†å›¾æ§åˆ¶å™¨-ğŸŸ-restoring-view-controllers-at-launch-time">åœ¨å¯åŠ¨æ—¶æ¢å¤è§†å›¾æ§åˆ¶å™¨ ğŸŸ Restoring View Controllers at Launch Time</a></li><li><a href="#å¯¹è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€è¿›è¡Œç¼–ç å’Œè§£ç -ğŸŸ-encoding-and-decoding-your-view-controller-s-state">å¯¹è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€è¿›è¡Œç¼–ç å’Œè§£ç  ğŸŸ Encoding and Decoding Your View Controllerâ€™s State</a></li><li><a href="#ä¿å­˜å’Œæ¢å¤è§†å›¾æ§åˆ¶å™¨çš„æç¤º-ğŸŸ-tips-for-saving-and-restoring-your-view-controllers">ä¿å­˜å’Œæ¢å¤è§†å›¾æ§åˆ¶å™¨çš„æç¤º ğŸŸ Tips for Saving and Restoring Your View Controllers</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="_1-å®šä¹‰ä½ çš„å­ç±»-ğŸŸ-define-your-subclass"><a href="#_1-å®šä¹‰ä½ çš„å­ç±»-ğŸŸ-define-your-subclass" class="header-anchor">#</a> 1. å®šä¹‰ä½ çš„å­ç±» ğŸŸ   define your subclass</h2> <p>You use custom subclasses of UIViewController to present your appâ€™s content. Most custom view controllers are content view controllersâ€”that is, they own all of their views and are responsible for the data in those views. By contrast, a container view controller does not own all of its views; some of its views are managed by other view controllers. Most of the steps for defining content and container view controllers are the same and are discussed in the sections that follow.</p> <p>æ‚¨å¯ä»¥ä½¿ç”¨<code>UIViewController</code>çš„è‡ªå®šä¹‰å­ç±»æ¥å‘ˆç°appçš„å†…å®¹ã€‚å¤§å¤šæ•°è‡ªå®šä¹‰è§†å›¾æ§åˆ¶å™¨éƒ½æ˜¯å†…å®¹è§†å›¾æ§åˆ¶å™¨â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬æ‹¥æœ‰è‡ªå·±çš„æ‰€æœ‰è§†å›¾ï¼Œå¹¶å¯¹è¿™äº›è§†å›¾ä¸­çš„æ•°æ®è´Ÿè´£ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå®¹å™¨è§†å›¾æ§åˆ¶å™¨å¹¶ä¸æ‹¥æœ‰è‡ªå·±çš„æ‰€æœ‰è§†å›¾ï¼›å®ƒçš„ä¸€äº›è§†å›¾ç”±å…¶ä»–è§†å›¾æ§åˆ¶å™¨ç®¡ç†ã€‚å®šä¹‰å†…å®¹å’Œå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å¤§å¤šæ•°æ­¥éª¤æ˜¯ç›¸åŒçš„ï¼Œå°†åœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ä¸­è®¨è®ºã€‚</p> <p>For content view controllers, the most common parent classes are as follows:</p> <p>å¯¹äºå†…å®¹è§†å›¾æ§åˆ¶å™¨ï¼Œæœ€å¸¸è§çš„çˆ¶ç±»å¦‚ä¸‹ï¼š</p> <ul><li><p>Use UITableViewController specifically when your view controllerâ€™s main view is a table.</p></li> <li><p>ä½¿ç”¨<code>UITableViewController</code>ç‰¹åˆ«å½“ä½ çš„è§†å›¾æ§åˆ¶å™¨çš„ä¸»è§†å›¾æ˜¯ä¸€ä¸ªè¡¨ã€‚</p></li> <li><p>Use UICollectionViewController specifically when your view controllerâ€™s main view is a collection view.</p></li> <li><p>å½“è§†å›¾æ§åˆ¶å™¨çš„ä¸»è§†å›¾æ˜¯é›†åˆè§†å›¾æ—¶ï¼Œè¯·ç‰¹åˆ«ä½¿ç”¨<code>UICollectionViewController</code>ã€‚</p></li> <li><p>Use UIViewController for all other view controllers.</p></li> <li><p>å¯¹æ‰€æœ‰å…¶ä»–è§†å›¾æ§åˆ¶å™¨ä½¿ç”¨<code>UIViewController</code>ã€‚</p></li></ul> <p>For container view controllers, the parent class depends on whether you are modifying an existing container class or creating your own. For existing containers, choose whichever view controller class you want to modify. For new container view controllers, you usually subclass UIViewController. For additional information about creating a container view controller, see Implementing a Container View Controller.</p> <p>å¯¹äºå®¹å™¨è§†å›¾æ§åˆ¶å™¨ï¼Œçˆ¶ç±»çš„é€‰æ‹©ï¼Œå–å†³äºæ‚¨æ˜¯ä¿®æ”¹ç°æœ‰å®¹å™¨ç±»è¿˜æ˜¯åˆ›å»ºè‡ªå·±çš„å®¹å™¨ç±»ã€‚å¯¹äºç°æœ‰å®¹å™¨ï¼Œé€‰æ‹©è¦ä¿®æ”¹çš„ä»»ä½•è§†å›¾æ§åˆ¶å™¨ç±»ã€‚å¯¹äºæ–°çš„å®¹å™¨è§†å›¾æ§åˆ¶å™¨ï¼Œé€šå¸¸æ˜¯UIViewControllerçš„å­ç±»ã€‚æœ‰å…³åˆ›å»ºå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å…¶ä»–ä¿¡æ¯ï¼Œè¯·å‚é˜…å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨<a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/ImplementingaContainerViewController.html#//apple_ref/doc/uid/TP40007457-CH11-SW1" target="_blank" rel="noopener noreferrer">åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="å®šä¹‰æ‚¨çš„ui-ğŸŸ-defining-your-ui"><a href="#å®šä¹‰æ‚¨çš„ui-ğŸŸ-defining-your-ui" class="header-anchor">#</a> å®šä¹‰æ‚¨çš„UI ğŸŸ Defining Your UI</h3> <p>Define the UI for your view controller visually using storyboard files in Xcode. Although you can also create your UI programmatically, storyboards are an excellent way to visualize your view controllerâ€™s content and customize your view hierarchy (as needed) for different environments. Building your UI visually lets you make changes quickly and lets you see the results without having to build and run your app.</p> <p>ä½¿ç”¨Xcodeä¸­çš„æ•…äº‹æ¿æ–‡ä»¶ç›´è§‚åœ°å®šä¹‰è§†å›¾æ§åˆ¶å™¨çš„UIã€‚è™½ç„¶æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼åˆ›å»ºUIï¼Œä½†æ•…äº‹æ¿æ˜¯å¯è§†åŒ–è§†å›¾æ§åˆ¶å™¨å†…å®¹å’Œé’ˆå¯¹ä¸åŒç¯å¢ƒè‡ªå®šä¹‰è§†å›¾å±‚æ¬¡ç»“æ„ï¼ˆæ ¹æ®éœ€è¦ï¼‰çš„ç»ä½³æ–¹å¼ã€‚å¯è§†åŒ–åœ°æ„å»ºUIå¯ä»¥è®©æ‚¨å¿«é€Ÿè¿›è¡Œæ›´æ”¹ï¼Œå¹¶è®©æ‚¨æ— éœ€æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºå³å¯æŸ¥çœ‹ç»“æœã€‚</p> <p>Figure 4-1 shows an example of a storyboard. Each of the rectangular areas represents a view controller and its associated views. The arrows between view controllers are the view controller relationships and segues. Relationships connect a container view controller to its child view controllers. Segues let you navigate between view controllers in your interface.</p> <p>å›¾4-1 æ˜¾ç¤ºäº†ä¸€ä¸ªæ•…äº‹æ¿ç¤ºä¾‹ã€‚æ¯ä¸ªçŸ©å½¢åŒºåŸŸä»£è¡¨ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨åŠå…¶å…³è”çš„è§†å›¾ã€‚è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„ç®­å¤´æ˜¯è§†å›¾æ§åˆ¶å™¨å…³ç³»å’Œ<code>segue/seÉ¡weÉª/è½¬åˆ°,æ¥å…¥</code>ã€‚å…³ç³»å°†å®¹å™¨è§†å›¾æ§åˆ¶å™¨è¿æ¥åˆ°å…¶å­è§†å›¾æ§åˆ¶å™¨ã€‚<code>Segue</code>å…è®¸æ‚¨åœ¨ç•Œé¢ä¸­çš„è§†å›¾æ§åˆ¶å™¨ä¹‹é—´å¯¼èˆªã€‚</p> <p>Figure 4-1A storyboard holds a set of view controllers and views</p> <p>å›¾4-1A æ•…äº‹æ¿åŒ…å«ä¸€ç»„è§†å›¾æ§åˆ¶å™¨å’Œè§†å›¾</p> <p><img src="/static_page/assets/img/storyboard_bird_sightings_2x.81a69ea5.png" alt=""></p> <p>Each new project has a main storyboard that typically contains one or more view controllers already. You can add new view controllers to your storyboard by dragging them from the library to your canvas. New view controllers do not have an associated class initially, so you must assign one using the Identity inspector.</p> <p>æ¯ä¸ªæ–°projectéƒ½æœ‰ä¸€ä¸ª<code>main storyboard</code>ï¼Œé€šå¸¸å·²ç»åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè§†å›¾æ§åˆ¶å™¨ã€‚æ‚¨å¯ä»¥é€šè¿‡å°†æ–°è§†å›¾æ§åˆ¶å™¨ä»åº“æ‹–åˆ°ç”»å¸ƒä¸­æ¥å°†å®ƒä»¬æ·»åŠ åˆ°æ•…äº‹æ¿ã€‚æ–°è§†å›¾æ§åˆ¶å™¨æœ€åˆæ²¡æœ‰å…³è”çš„ç±»ï¼Œå› æ­¤æ‚¨å¿…é¡»ä½¿ç”¨èº«ä»½æ£€æŸ¥å™¨åˆ†é…ä¸€ä¸ªã€‚</p> <p>Use the storyboard editor to do the following:</p> <p>ä½¿ç”¨æ•…äº‹æ¿ç¼–è¾‘å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p> <ul><li><p>Add, arrange, and configure the views for a view controller.</p></li> <li><p>ä¸ºè§†å›¾æ§åˆ¶å™¨æ·»åŠ ã€æ’åˆ—å’Œé…ç½®è§†å›¾ã€‚</p></li> <li><p>Connect outlets and actions; see Handling User Interactions.</p></li> <li><p>è¿æ¥æ’åº§å’Œæ“ä½œï¼›è¯·å‚é˜…å¤„ç†ç”¨æˆ·äº¤äº’<a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/DefiningYourSubclass.html#//apple_ref/doc/uid/TP40007457-CH7-SW11" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></li> <li><p>Create relationships and segues between your view controllers; see Using Segues.</p></li> <li><p>åœ¨è§†å›¾æ§åˆ¶å™¨ä¹‹é—´åˆ›å»ºå…³ç³»å’Œsegueï¼›è¯·å‚é˜…ä½¿ç”¨segue<a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/UsingSegues.html#//apple_ref/doc/uid/TP40007457-CH15-SW1" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></li> <li><p>Customize your layout and views for different size classes; see Building an Adaptive Interface.</p></li> <li><p>ä¸ºä¸åŒå¤§å°çš„ç±»è‡ªå®šä¹‰å¸ƒå±€å’Œè§†å›¾ï¼›è¯·å‚é˜…æ„å»ºè‡ªé€‚åº”æ¥å£<a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/BuildinganAdaptiveInterface.html#//apple_ref/doc/uid/TP40007457-CH32-SW1" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></li> <li><p>Add gesture recognizers to handle user interactions with views; see Event Handling Guide for iOS.</p></li> <li><p>æ·»åŠ æ‰‹åŠ¿è¯†åˆ«å™¨æ¥å¤„ç†ç”¨æˆ·ä¸è§†å›¾çš„äº¤äº’ï¼›æœ‰å…³iOSï¼Œè¯·å‚é˜…<em>äº‹ä»¶å¤„ç†æŒ‡å—</em>ã€‚</p></li></ul> <p>If you are new to using storyboards to build your interface, you can find step-by-step instructions for creating a storyboard-based interface in Start Developing iOS Apps Today (Retired).</p> <p>å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ä½¿ç”¨æ•…äº‹æ¿æ„å»ºç•Œé¢ï¼Œæ‚¨å¯ä»¥åœ¨ç«‹å³å¼€å§‹å¼€å‘iOSåº”ç”¨ç¨‹åºï¼ˆè¿‡æ—¶ï¼‰<a href="https://developer.apple.com/library/archive/referencelibrary/GettingStarted/RoadMapiOS-Legacy/chapters/Introduction.html" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸­æ‰¾åˆ°åˆ›å»ºåŸºäºæ•…äº‹æ¿çš„ç•Œé¢çš„åˆ†æ­¥è¯´æ˜ã€‚</p> <h3 id="å¤„ç†ç”¨æˆ·äº¤äº’-ğŸŸ-handling-user-interactions"><a href="#å¤„ç†ç”¨æˆ·äº¤äº’-ğŸŸ-handling-user-interactions" class="header-anchor">#</a> å¤„ç†ç”¨æˆ·äº¤äº’ ğŸŸ Handling User Interactions</h3> <p>An appâ€™s responder objects process incoming events and take appropriate actions. Although view controllers are responder objects, they rarely process touch events directly. Instead, view controllers typically handle events in the following ways.</p> <p>åº”ç”¨ç¨‹åºçš„<code>responder</code>å¯¹è±¡å¤„ç†ä¼ å…¥äº‹ä»¶å¹¶é‡‡å–é€‚å½“çš„æ“ä½œã€‚è™½ç„¶è§†å›¾æ§åˆ¶å™¨æ˜¯å“åº”è€…å¯¹è±¡ï¼Œä½†å®ƒä»¬å¾ˆå°‘ç›´æ¥å¤„ç†è§¦æ‘¸äº‹ä»¶ã€‚ç›¸åï¼Œè§†å›¾æ§åˆ¶å™¨é€šå¸¸ä»¥ä»¥ä¸‹æ–¹å¼å¤„ç†äº‹ä»¶ã€‚</p> <ul><li><p>View controllers define action methods for handling higher-level events. Action methods respond to:</p></li> <li><p><strong>è§†å›¾æ§åˆ¶å™¨å®šä¹‰ç”¨äºå¤„ç†<code>higher-level events</code>çš„<code>action</code>æ–¹æ³•ã€‚æ“ä½œæ–¹æ³•å“åº”ä¸€ä¸‹åŠ¨ä½œ:</strong></p> <ul><li><p>Specific actions. Controls and some views call an action method to report specific interactions.</p></li> <li><p>ç‰¹å®šçš„<code>action</code>ã€‚æ§ä»¶å’Œä¸€äº›è§†å›¾è°ƒç”¨<code>action</code>æ–¹æ³•æ¥å¤„ç†ç‰¹å®šçš„äº¤äº’ã€‚</p></li> <li><p>Gesture recognizers. Gesture recognizers call an action method to report the current status of a gesture. Use your view controller to process status changes or respond to the completed gesture.</p></li> <li><p>æ‰‹åŠ¿è¯†åˆ«å™¨ã€‚æ‰‹åŠ¿è¯†åˆ«å™¨è°ƒç”¨<code>action</code>æ–¹æ³•æ¥æŠ¥å‘Šæ‰‹åŠ¿çš„å½“å‰çŠ¶æ€ã€‚ä½¿ç”¨è§†å›¾æ§åˆ¶å™¨æ¥å¤„ç†çŠ¶æ€æ›´æ”¹æˆ–å“åº”å®Œæˆçš„æ‰‹åŠ¿ã€‚</p></li></ul></li> <li><p>View controllers observe notifications sent by the system or other objects. Notifications report changes and are a way for the view controller to update its state.</p></li> <li><p><strong>è§†å›¾æ§åˆ¶å™¨ç›‘å¬ç³»ç»Ÿæˆ–å…¶ä»–å¯¹è±¡å‘é€çš„<code>notification</code></strong>ã€‚<code>notification</code>è§¦å‘æ›´æ”¹ï¼Œæ˜¯è§†å›¾æ§åˆ¶å™¨æ›´æ–°å…¶çŠ¶æ€çš„ä¸€ç§æ–¹å¼ã€‚</p></li> <li><p>View controllers act as a data source or delegate for another object. View controllers are often used to manage the data for tables, and collection views. You can also use them as a delegate for an object such as a CLLocationManager object, which sends updated location values to its delegate.</p></li> <li><p><strong>è§†å›¾æ§åˆ¶å™¨å……å½“å¦ä¸€ä¸ªå¯¹è±¡çš„<code>data source</code>æˆ–<code>delegate</code></strong>ã€‚è§†å›¾æ§åˆ¶å™¨é€šå¸¸ç”¨äºç®¡ç†è¡¨å’Œé›†åˆè§†å›¾çš„æ•°æ®ã€‚æ‚¨è¿˜å¯ä»¥å°†å®ƒä»¬ç”¨ä½œå¯¹è±¡çš„å§”æ‰˜ï¼Œä¾‹å¦‚<a href="https://developer.apple.com/documentation/corelocation/cllocationmanager" target="_blank" rel="noopener noreferrer"><code>CLLocationManager</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>å¯¹è±¡ï¼Œå®ƒå°†æ›´æ–°çš„ä½ç½®å€¼å‘é€ç»™å…¶å§”æ‰˜ã€‚</p></li></ul> <p>Responding to events often involves updating the content of views, which requires having references to those views. Your view controller is a good place to define outlets for any views that you need to modify later. Declare your outlets as properties using the syntax shown in Listing 4-1. The custom class in the listing defines two outlets (designated by the IBOutlet keyword) and a single action method (designated by the IBAction return type). The outlets store references to a button and a text field in the storyboard, while the action method responds to taps in the button.</p> <p>å“åº”äº‹ä»¶é€šå¸¸æ¶‰åŠåˆ°æ›´æ–°è§†å›¾çš„å†…å®¹ï¼Œè¿™éœ€è¦å¯¹è¿™äº›è§†å›¾è¿›è¡Œå¼•ç”¨ã€‚è§†å›¾æ§åˆ¶å™¨æ˜¯ä¸ºä»¥åéœ€è¦ä¿®æ”¹çš„ä»»ä½•è§†å›¾å®šä¹‰<code>outlets</code>çš„å¥½åœ°æ–¹ã€‚ä½¿ç”¨æ¸…å•4-1ä¸­æ‰€ç¤ºçš„è¯­æ³•å°†<code>outlets</code>å£°æ˜ä¸ºå±æ€§ã€‚æ¸…å•ä¸­çš„è‡ªå®šä¹‰ç±»å®šä¹‰äº†ä¸¤ä¸ª<code>outlets</code>ï¼ˆç”±<code>IBOutlet</code>å…³é”®å­—æŒ‡å®šï¼‰å’Œä¸€ä¸ªæ“ä½œæ–¹æ³•ï¼ˆç”±<code>IBAction</code>è¿”å›ç±»å‹æŒ‡å®šï¼‰ã€‚<code>outlets</code>å­˜å‚¨å¯¹æ•…äº‹æ¿ä¸­æŒ‰é’®å’Œæ–‡æœ¬å­—æ®µçš„å¼•ç”¨ï¼Œè€Œæ“ä½œæ–¹æ³•å“åº”æŒ‰é’®ä¸­çš„ç‚¹å‡»ã€‚</p> <p>Listing 4-1Defining outlets and actions in a view controller class</p> <p>æ¸…å•4-1 åœ¨è§†å›¾æ§åˆ¶å™¨ç±»ä¸­å®šä¹‰<code>outlets</code>å’Œ<code>action</code></p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token keyword">@interface</span> MyViewController <span class="token punctuation">:</span> UIViewController
<span class="token keyword">@property</span> <span class="token punctuation">(</span>weak<span class="token punctuation">,</span> nonatomic<span class="token punctuation">)</span> IBOutlet UIButton <span class="token operator">*</span>myButton<span class="token punctuation">;</span>
<span class="token keyword">@property</span> <span class="token punctuation">(</span>weak<span class="token punctuation">,</span> nonatomic<span class="token punctuation">)</span> IBOutlet UITextField <span class="token operator">*</span>myTextField<span class="token punctuation">;</span>
 
<span class="token operator">-</span> <span class="token punctuation">(</span>IBAction<span class="token punctuation">)</span>myButtonAction<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>sender<span class="token punctuation">;</span>
 
<span class="token keyword">@end</span>

class MyViewController<span class="token punctuation">:</span> UIViewController <span class="token punctuation">{</span>
    <span class="token operator">@</span>IBOutlet weak var myButton <span class="token punctuation">:</span> UIButton<span class="token operator">!</span>
    <span class="token operator">@</span>IBOutlet weak var myTextField <span class="token punctuation">:</span> UITextField<span class="token operator">!</span>
    
    <span class="token operator">@</span>IBAction func <span class="token function">myButtonAction</span><span class="token punctuation">(</span>sender<span class="token punctuation">:</span> id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>In your storyboard, remember to connect your view controllerâ€™s outlets and actions to the corresponding views. Connecting outlets and actions in your storyboard file ensures that they are configured when the views are loaded. For information about how to create outlet and action connections in Interface Builder, see Interface Builder Connections Help. For information about how to handle events in your app, see Event Handling Guide for iOS.</p> <p>åœ¨æ•…äº‹æ¿ä¸­ï¼Œè¯·è®°ä½å°†è§†å›¾æ§åˆ¶å™¨çš„<code>outlets</code>å’Œ<code>actions</code>è¿æ¥åˆ°ç›¸åº”çš„è§†å›¾ã€‚åœ¨æ•…äº‹æ¿æ–‡ä»¶ä¸­è¿æ¥å‡ºå£å’Œæ“ä½œå¯ç¡®ä¿åœ¨åŠ è½½è§†å›¾æ—¶é…ç½®å®ƒä»¬ã€‚æœ‰å…³å¦‚ä½•åœ¨<code>Interface Builder</code>ä¸­åˆ›å»º<code>outlets</code>å’Œ<code>actions</code>è¿æ¥çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…<code>Interface Builder</code>è¿æ¥å¸®åŠ©ã€‚æœ‰å…³å¦‚ä½•å¤„ç†åº”ç”¨ä¸­çš„äº‹ä»¶çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…<em>äº‹ä»¶å¤„ç†æŒ‡å—iOS</em>ã€‚</p> <h3 id="åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºæ‚¨çš„è§†å›¾-ğŸŸ-displaying-your-views-at-runtime"><a href="#åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºæ‚¨çš„è§†å›¾-ğŸŸ-displaying-your-views-at-runtime" class="header-anchor">#</a> åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºæ‚¨çš„è§†å›¾ ğŸŸ Displaying Your Views at Runtime</h3> <p>Storyboards make the process of loading and displaying your view controllerâ€™s views very simple. UIKit automatically loads views from your storyboard file when they are needed. As part of the loading process, UIKit performs the following sequence of tasks:</p> <p>æ•…äº‹æ¿ä½¿åŠ è½½å’Œæ˜¾ç¤ºè§†å›¾æ§åˆ¶å™¨è§†å›¾çš„è¿‡ç¨‹éå¸¸ç®€å•ã€‚UIKitä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨ä»æ•…äº‹æ¿æ–‡ä»¶ä¸­åŠ è½½è§†å›¾ã€‚ä½œä¸ºåŠ è½½è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼ŒUIKitæ‰§è¡Œä»¥ä¸‹ä»»åŠ¡åºåˆ—ï¼š</p> <ul><li><p>Instantiates views using the information in your storyboard file.</p></li> <li><p>ä½¿ç”¨æ•…äº‹æ¿æ–‡ä»¶ä¸­çš„ä¿¡æ¯å®ä¾‹åŒ–è§†å›¾ã€‚</p></li> <li><p>Connects all outlets and actions.</p></li> <li><p>è¿æ¥æ‰€æœ‰å‡ºå£å’Œæ“ä½œã€‚</p></li> <li><p>Assigns the root view to the view controllerâ€™s view property.</p></li> <li><p>å°†æ ¹è§†å›¾åˆ†é…ç»™è§†å›¾æ§åˆ¶å™¨çš„<code>view</code>å±æ€§ã€‚</p></li> <li><p>Calls the view controllerâ€™s awakeFromNib method.</p></li> <li><p>è°ƒç”¨è§†å›¾æ§åˆ¶å™¨çš„<code>awakeFromNib</code>æ–¹æ³•ã€‚</p> <p>When this method is called, the view controllerâ€™s trait collection is empty and views may not be in their final positions.</p> <p>è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œè§†å›¾æ§åˆ¶å™¨çš„<code>trait</code>é›†åˆä¸ºç©ºï¼Œè§†å›¾å¯èƒ½ä¸åœ¨å…¶æœ€ç»ˆä½ç½®ã€‚</p></li> <li><p>Calls the view controllerâ€™s viewDidLoad method.</p></li> <li><p>è°ƒç”¨è§†å›¾æ§åˆ¶å™¨çš„viewDidLoadæ–¹æ³•ã€‚</p> <p>Use this method to add or remove views, modify layout constraints, and load data for your views.</p> <p>ä½¿ç”¨æ­¤æ–¹æ³•ä¸ºæ‚¨çš„è§†å›¾æ·»åŠ æˆ–åˆ é™¤è§†å›¾ã€ä¿®æ”¹å¸ƒå±€çº¦æŸä»¥åŠåŠ è½½æ•°æ®ã€‚</p></li></ul> <p>Before displaying a view controllerâ€™s views onscreen, UIKit gives you some additional chances to prepare those views before and after they are onscreen. Specifically, UIKit performs the following sequence of tasks:</p> <p>åœ¨å±å¹•ä¸Šæ˜¾ç¤ºè§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ä¹‹å‰ï¼ŒUIKitä¸ºæ‚¨æä¾›äº†ä¸€äº›é¢å¤–çš„æœºä¼šæ¥å‡†å¤‡è¿™äº›è§†å›¾åœ¨å±å¹•ä¸Šä¹‹å‰å’Œä¹‹åã€‚å…·ä½“æ¥è¯´ï¼ŒUIKitæ‰§è¡Œä»¥ä¸‹ä»»åŠ¡åºåˆ—ï¼š</p> <ul><li><p>Calls the view controllerâ€™s viewWillAppear: method to let it know that its views are about to appear onscreen.</p></li> <li><p>è°ƒç”¨è§†å›¾æ§åˆ¶å™¨çš„viewWillAppear:æ–¹æ³•ï¼Œè®©å®ƒçŸ¥é“å®ƒçš„è§†å›¾å³å°†å‡ºç°åœ¨å±å¹•ä¸Šã€‚</p></li> <li><p>Updates the layout of the views.</p></li> <li><p>æ›´æ–°è§†å›¾çš„å¸ƒå±€ã€‚</p></li> <li><p>Displays the views onscreen.</p></li> <li></li></ul> <p>åœ¨å±å¹•ä¸Šæ˜¾ç¤ºè§†å›¾ã€‚</p> <ul><li><p>Calls the viewDidAppear: method when the views are onscreen.</p></li> <li><p>å½“è§†å›¾å‡ºç°åœ¨å±å¹•ä¸Šæ—¶è°ƒç”¨<a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/1621423-viewdidappear" target="_blank" rel="noopener noreferrer"><code>viewDidAppear:</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ–¹æ³•ã€‚</p></li></ul> <p>When you add, remove, or modify the size or position of views, remember to add and remove any constraints that apply to those views. Making layout-related changes to your view hierarchy causes UIKit to mark the layout as dirty. During the next update cycle, the layout engine computes the size and position of views using the current layout constraints and applies those changes to the view hierarchy.</p> <p>æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹è§†å›¾çš„å¤§å°æˆ–ä½ç½®æ—¶ï¼Œè¯·è®°ä½æ·»åŠ å’Œåˆ é™¤å¯¹åº”çš„ä»»ä½•å¸ƒå±€çº¦æŸã€‚å¯¹è§†å›¾å±‚æ¬¡ç»“æ„è¿›è¡Œä¸å¸ƒå±€ç›¸å…³çš„æ›´æ”¹ä¼šå¯¼è‡´UIKitå°†å¸ƒå±€æ ‡è®°ä¸ºè„ã€‚åœ¨ä¸‹ä¸€ä¸ªæ›´æ–°å‘¨æœŸä¸­ï¼Œå¸ƒå±€å¼•æ“ä½¿ç”¨å½“å‰å¸ƒå±€çº¦æŸè®¡ç®—è§†å›¾çš„å¤§å°å’Œä½ç½®ï¼Œå¹¶å°†è¿™äº›æ›´æ”¹åº”ç”¨äºè§†å›¾å±‚æ¬¡ç»“æ„ã€‚</p> <p>For information about how to create views without using storyboards, see the view management information in UIViewController Class Reference.</p> <p>æœ‰å…³å¦‚ä½•åœ¨ä¸ä½¿ç”¨æ•…äº‹æ¿çš„æƒ…å†µä¸‹åˆ›å»ºè§†å›¾çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://developer.apple.com/documentation/uikit/uiviewcontroller" target="_blank" rel="noopener noreferrer">UIViewController<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ç±»å‚è€ƒä¸­çš„è§†å›¾ç®¡ç†ä¿¡æ¯ã€‚</p> <h3 id="ç®¡ç†è§†å›¾å¸ƒå±€-ğŸŸ-managing-view-layout"><a href="#ç®¡ç†è§†å›¾å¸ƒå±€-ğŸŸ-managing-view-layout" class="header-anchor">#</a> ç®¡ç†è§†å›¾å¸ƒå±€ ğŸŸ Managing View Layout</h3> <p>When the size and position of views changes, UIKit updates the layout information for your view hierarchy. For views configured using Auto Layout, UIKit engages the Auto Layout engine and uses it to update the layout according to the current constraints. UIKit also lets other interested objects, such as the active presentation controller, know abut the layout changes so that they can respond accordingly.</p> <p>å½“è§†å›¾çš„å¤§å°å’Œä½ç½®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒUIKitä¼šæ›´æ–°è§†å›¾å±‚æ¬¡ç»“æ„çš„å¸ƒå±€ä¿¡æ¯ã€‚å¯¹äºä½¿ç”¨è‡ªåŠ¨å¸ƒå±€é…ç½®çš„è§†å›¾ï¼ŒUIKitä¼šå¯åŠ¨è‡ªåŠ¨å¸ƒå±€å¼•æ“ï¼Œå¹¶ä½¿ç”¨å®ƒæ ¹æ®å½“å‰çº¦æŸæ›´æ–°å¸ƒå±€ã€‚UIKitè¿˜å…è®¸å…¶ä»–æ„Ÿå…´è¶£çš„å¯¹è±¡ï¼ˆä¾‹å¦‚æ´»åŠ¨è¡¨ç¤ºæ§åˆ¶å™¨ï¼‰äº†è§£å¸ƒå±€æ›´æ”¹ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥åšå‡ºç›¸åº”çš„å“åº”ã€‚</p> <p>During the layout process, UIKit notifies you at several points so that you can perform additional layout-related tasks. Use these notifications to modify your layout constraints or to make final tweaks to the layout after the layout constraints have been applied. During the layout process, UIKit does the following for each affected view controller:</p> <p>åœ¨å¸ƒå±€è¿‡ç¨‹ä¸­ï¼ŒUIKitä¼šåœ¨å‡ ä¸ªç‚¹é€šçŸ¥æ‚¨ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æ‰§è¡Œå…¶ä»–ä¸å¸ƒå±€ç›¸å…³çš„ä»»åŠ¡ã€‚ä½¿ç”¨è¿™äº›é€šçŸ¥æ¥ä¿®æ”¹å¸ƒå±€çº¦æŸæˆ–åœ¨åº”ç”¨å¸ƒå±€çº¦æŸåå¯¹å¸ƒå±€è¿›è¡Œæœ€ç»ˆè°ƒæ•´ã€‚åœ¨å¸ƒå±€è¿‡ç¨‹ä¸­ï¼ŒUIKitå¯¹æ¯ä¸ªå—å½±å“çš„è§†å›¾æ§åˆ¶å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p> <ol><li><p>Updates the trait collections of the view controller and its views, as needed; see When Do Trait and Size Changes Happen?</p></li> <li><p>æ ¹æ®éœ€è¦æ›´æ–°è§†å›¾æ§åˆ¶å™¨åŠå…¶è§†å›¾çš„<code>trait</code>é›†åˆï¼›è¯·å‚é˜…:ä½•æ—¶å‘ç”Ÿ<code>Trait</code>å’Œ<code>Size</code>æ›´æ”¹<a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/TheAdaptiveModel.html#//apple_ref/doc/uid/TP40007457-CH19-SW6" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Ÿ</p></li> <li><p>Calls the view controllerâ€™s viewWillLayoutSubviews method.</p></li> <li><p>è°ƒç”¨è§†å›¾æ§åˆ¶å™¨çš„viewWillLayoutSubviewsæ–¹æ³•ã€‚</p></li> <li><p>Calls the containerViewWillLayoutSubviews method of the current UIPresentationController object.</p></li> <li><p>è°ƒç”¨å½“å‰<code>UIPresentationController</code>å¯¹è±¡çš„<code>containerViewWillLayoutSubviews</code>ã€‚</p></li> <li><p>Calls the layoutSubviews method of view controllerâ€™s root view.</p></li> <li><p>è°ƒç”¨è§†å›¾æ§åˆ¶å™¨çš„æ ¹è§†å›¾çš„layoutSubviewsæ–¹æ³•ã€‚</p> <p>The default implementation of this method computes the new layout information using the available constraints. The method then traverses the view hierarchy and calls layoutSubviews for each subview.</p> <p>æ­¤æ–¹æ³•çš„é»˜è®¤å®ç°ä½¿ç”¨å¯ç”¨çº¦æŸè®¡ç®—æ–°çš„å¸ƒå±€ä¿¡æ¯ã€‚ç„¶åï¼Œè¯¥æ–¹æ³•éå†è§†å›¾å±‚æ¬¡ç»“æ„å¹¶ä¸ºæ¯ä¸ªå­è§†å›¾è°ƒç”¨<code>layoutSubviews</code>ã€‚</p></li> <li><p>Applies the computed layout information to the views.</p></li> <li><p>å°†è®¡ç®—çš„å¸ƒå±€ä¿¡æ¯åº”ç”¨äºè§†å›¾ã€‚</p></li> <li><p>Calls the view controllerâ€™s viewDidLayoutSubviews method.</p></li> <li><p>è°ƒç”¨è§†å›¾æ§åˆ¶å™¨çš„<code>viewDidLayoutSubviews</code>æ–¹æ³•ã€‚</p></li> <li><p>Calls the containerViewDidLayoutSubviews method of the current UIPresentationController object.</p></li> <li><p>è°ƒç”¨å½“å‰<code>UIPresentationController</code>å¯¹è±¡çš„<code>containerViewDidLayoutSubviews</code>å­è§†å›¾æ–¹æ³•ã€‚</p></li></ol> <p>View controllers can use the viewWillLayoutSubviews and viewDidLayoutSubviews methods to perform additional updates that might impact the layout process. Before layout, you might add or remove views, update the size or position of views, update constraints, or update other view-related properties. After layout, you might reload table data, update the content of other views, or make final adjustments to the size and position of views.</p> <p>è§†å›¾æ§åˆ¶å™¨å¯ä»¥ä½¿ç”¨<code>viewWillLayoutSubviews</code>å’Œ<code>viewDidLayoutSubviews</code>æ–¹æ³•æ¥æ‰§è¡Œå¯èƒ½ä¼šå½±å“å¸ƒå±€è¿‡ç¨‹çš„å…¶ä»–æ›´æ–°ã€‚åœ¨å¸ƒå±€ä¹‹å‰ï¼Œæ‚¨å¯ä»¥æ·»åŠ æˆ–åˆ é™¤è§†å›¾ã€æ›´æ–°è§†å›¾çš„å¤§å°æˆ–ä½ç½®ã€æ›´æ–°çº¦æŸæˆ–æ›´æ–°å…¶ä»–ä¸è§†å›¾ç›¸å…³çš„å±æ€§ã€‚å¸ƒå±€ä¹‹åï¼Œæ‚¨å¯ä»¥é‡æ–°åŠ è½½è¡¨æ•°æ®ã€æ›´æ–°å…¶ä»–è§†å›¾çš„å†…å®¹æˆ–å¯¹è§†å›¾çš„å¤§å°å’Œä½ç½®è¿›è¡Œæœ€ç»ˆè°ƒæ•´ã€‚</p> <p>Here are some tips for managing your layout effectively:</p> <p>ä»¥ä¸‹æ˜¯æœ‰æ•ˆç®¡ç†å¸ƒå±€çš„ä¸€äº›æŠ€å·§ï¼š</p> <ol><li><p>Use Auto Layout. The constraints you create using Auto Layout are a flexible and easy way to position your content on different screen sizes.</p></li> <li><p><strong>ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€</strong>ã€‚æ‚¨ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€åˆ›å»ºçš„çº¦æŸæ˜¯åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸Šå®šä½å†…å®¹çš„ä¸€ç§çµæ´»è€Œç®€å•çš„æ–¹æ³•ã€‚</p></li> <li><p>Take advantage of the top and bottom layout guides. Laying out content to these guides ensures that your content is always visible. The position of the top layout guide factors in the height of the status bar and navigation bar. Similarly, the position of the bottom layout guide factors in the height of a tab bar or toolbar.</p></li> <li><p><strong>åˆ©ç”¨é¡¶éƒ¨å’Œåº•éƒ¨<code>layout guide</code></strong>ã€‚å°†å†…å®¹å¸ƒå±€åˆ°è¿™äº›<code>guides</code>å¯ç¡®ä¿æ‚¨çš„å†…å®¹å§‹ç»ˆå¯è§ã€‚<code>top layout guide</code>çš„ä½ç½®å½±å“çŠ¶æ€æ å’Œå¯¼èˆªæ çš„é«˜åº¦ã€‚åŒæ ·ï¼Œ<code>bottom layout guide</code>çš„ä½ç½®å½±å“æ ‡ç­¾æ æˆ–å·¥å…·æ çš„é«˜åº¦ã€‚</p> <p>Remember to update constraints when adding or removing views. If you add or remove views dynamically, remember to update the corresponding constraints.</p> <p>æ·»åŠ æˆ–åˆ é™¤è§†å›¾æ—¶è¯·è®°ä½æ›´æ–°çº¦æŸã€‚å¦‚æœæ‚¨åŠ¨æ€æ·»åŠ æˆ–åˆ é™¤è§†å›¾ï¼Œè¯·è®°ä½æ›´æ–°ç›¸åº”çš„çº¦æŸã€‚</p></li> <li><p>Remove constraints temporarily while animating your view controllerâ€™s views. When animating views using UIKit Core Animation, remove your constraints for the duration of the animations and add them back when the animations finish. Remember to update your constraints if the position or size of your views changed during the animation.</p></li> <li><p><strong>åœ¨ä¸ºè§†å›¾æ§åˆ¶å™¨çš„è§†å›¾åˆ¶ä½œåŠ¨ç”»æ—¶æš‚æ—¶åˆ é™¤çº¦æŸ</strong>ã€‚ä½¿ç”¨<code>UIKit Core Animation</code>ä¸ºè§†å›¾åˆ¶ä½œåŠ¨ç”»æ—¶ï¼Œè¯·åœ¨åŠ¨ç”»æœŸé—´åˆ é™¤çº¦æŸï¼Œå¹¶åœ¨åŠ¨ç”»å®Œæˆæ—¶å°†å…¶æ·»åŠ å›æ¥ã€‚å¦‚æœè§†å›¾çš„ä½ç½®æˆ–å¤§å°åœ¨åŠ¨ç”»æœŸé—´å‘ç”Ÿå˜åŒ–ï¼Œè¯·è®°ä½æ›´æ–°çº¦æŸã€‚</p></li></ol> <p>For information about presentation controllers and the role they play in the view controller architecture, see The Presentation and Transition Process.</p> <p>æœ‰å…³è¡¨ç¤ºæ§åˆ¶å™¨åŠå…¶åœ¨è§†å›¾æ§åˆ¶å™¨ä½“ç³»ç»“æ„ä¸­æ‰®æ¼”çš„è§’è‰²çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…å‘ˆç°å’Œè½¬æ¢å¤„ç†<a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/PresentingaViewController.html#//apple_ref/doc/uid/TP40007457-CH14-SW7" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="æœ‰æ•ˆç®¡ç†å†…å­˜-ğŸŸ-managing-memory-efficiently"><a href="#æœ‰æ•ˆç®¡ç†å†…å­˜-ğŸŸ-managing-memory-efficiently" class="header-anchor">#</a> æœ‰æ•ˆç®¡ç†å†…å­˜ ğŸŸ Managing Memory Efficiently</h3> <p>Although most aspects of memory allocation are for you to decide, Table 4-1 lists the methods of UIViewController where you are most likely to allocate or deallocate memory. Most deallocations involve removing strong references to objects. To remove a strong reference to an object, set properties and variables pointing to that object to nil.</p> <p>å°½ç®¡å†…å­˜åˆ†é…çš„å¤§å¤šæ•°æ–¹é¢ç”±æ‚¨å†³å®šï¼Œä½†è¡¨4-1åˆ—å‡ºäº†<code>UIViewController</code>æœ€æœ‰å¯èƒ½åˆ†é…æˆ–é‡Šæ”¾å†…å­˜çš„æ–¹æ³•ã€‚å¤§å¤šæ•°é‡Šæ”¾æ¶‰åŠåˆ é™¤å¯¹å¯¹è±¡çš„å¼ºå¼•ç”¨ã€‚è¦åˆ é™¤å¯¹å¯¹è±¡çš„å¼ºå¼•ç”¨ï¼Œè¯·å°†æŒ‡å‘è¯¥å¯¹è±¡çš„å±æ€§å’Œå˜é‡è®¾ç½®ä¸º<code>nil</code>ã€‚</p> <p>Table 4-1Places to allocate and deallocate memory</p> <p>è¡¨4-1åˆ†é…å’Œé‡Šæ”¾å†…å­˜çš„ä½ç½®</p> <table><thead><tr><th>Task</th> <th>Methods</th> <th>Discussion</th></tr></thead> <tbody><tr><td>Allocate critical data structures required by your view controller.</td> <td>Initialization methods</td> <td>Your customÂ initializationÂ method (whether it is namedÂ initÂ or something else) is always responsible for putting your view controller object into a known good state. Use these methods to allocate whatever data structures are needed to ensure proper operation.</td></tr> <tr><td>Allocate or load data to be displayed in your view.</td> <td>viewDidLoad</td> <td>Use theÂ viewDidLoadÂ method to load any data objects you intend to display. By the time this method is called, your view objects are guaranteed to exist and to be in a known good state.</td></tr> <tr><td>Respond to low-memory notifications.</td> <td>didReceiveMemoryWarning</td> <td>Use this method to deallocate all noncritical objects associated with your view controller. Deallocate as much memory as you can.</td></tr> <tr><td>Release critical data structures required by your view controller.</td> <td>dealloc</td> <td>Override this method only to perform any last-minute cleanup of your view controller class. The system automatically releases objects stored in instance variables and properties of your class, so you do not need to release those explicitly.</td></tr></tbody></table> <table><thead><tr><th>task</th> <th>method</th> <th>Discussion</th></tr></thead> <tbody><tr><td>åˆ†é…VCéœ€çš„å…³é”®æ•°æ®ç»“æ„ã€‚</td> <td><code>Initialization methods</code></td> <td>æ‚¨çš„è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•ï¼ˆæ— è®ºæ˜¯å‘½åä¸ºinitè¿˜æ˜¯å…¶ä»–åç§°ï¼‰æ€»æ˜¯è´Ÿè´£å°†æ‚¨çš„è§†å›¾æ§åˆ¶å™¨å¯¹è±¡ç½®äºå·²çŸ¥çš„è‰¯å¥½çŠ¶æ€ã€‚ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥åˆ†é…ç¡®ä¿æ­£ç¡®æ“ä½œæ‰€éœ€çš„ä»»ä½•æ•°æ®ç»“æ„ã€‚</td></tr> <tr><td>åˆ†é…æˆ–åŠ è½½è¦åœ¨è§†å›¾ä¸­æ˜¾ç¤ºçš„dataã€‚</td> <td><code>viewDidLoad</code></td> <td>ä½¿ç”¨viewDidLoadæ–¹æ³•åŠ è½½æ‚¨è¦æ˜¾ç¤ºçš„ä»»ä½•æ•°æ®å¯¹è±¡ã€‚è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œæ‚¨çš„è§†å›¾å¯¹è±¡ä¿è¯å­˜åœ¨å¹¶å¤„äºå·²çŸ¥çš„è‰¯å¥½çŠ¶æ€ã€‚</td></tr> <tr><td>å“åº”ä½å†…å­˜é€šçŸ¥ã€‚</td> <td><code>didReceiveMemoryWarning</code></td> <td>ä½¿ç”¨æ­¤æ–¹æ³•é‡Šæ”¾ä¸è§†å›¾æ§åˆ¶å™¨å…³è”çš„æ‰€æœ‰éå…³é”®å¯¹è±¡ã€‚å°½å¯èƒ½å¤šåœ°é‡Šæ”¾å†…å­˜ã€‚</td></tr> <tr><td>é‡Šæ”¾VCæ‰€éœ€çš„å…³é”®æ•°æ®ç»“æ„ã€‚</td> <td><code>dealloc</code></td> <td>é‡å†™æ­¤æ–¹æ³•åªæ˜¯ä¸ºäº†å¯¹è§†å›¾æ§åˆ¶å™¨ç±»æ‰§è¡Œ<code>last-minute</code>çš„æ¸…ç†ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨é‡Šæ”¾å­˜å‚¨åœ¨ç±»çš„å®ä¾‹å˜é‡å’Œå±æ€§ä¸­çš„å¯¹è±¡ï¼Œå› æ­¤æ‚¨ä¸éœ€è¦æ˜¾å¼é‡Šæ”¾è¿™äº›å¯¹è±¡ã€‚</td></tr></tbody></table> <h2 id="_2-å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-implementing-a-container-view-controller"><a href="#_2-å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-implementing-a-container-view-controller" class="header-anchor">#</a> 2. å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨ ğŸŸ Implementing a Container View Controller</h2> <p>Container view controllers are a way to combine the content from multiple view controllers into a single user interface. Container view controllers are most often used to facilitate navigation and to create new user interface types based on existing content. Examples of container view controllers in UIKit include UINavigationController, UITabBarController, and UISplitViewController, all of which facilitate navigation between different parts of your user interface.</p> <p>å®¹å™¨è§†å›¾æ§åˆ¶å™¨æ˜¯ä¸€ç§å°†æ¥è‡ªå¤šä¸ªè§†å›¾æ§åˆ¶å™¨çš„å†…å®¹ç»„åˆæˆå•ä¸ªç”¨æˆ·äº¤äº’ç•Œé¢çš„æ–¹æ³•ã€‚å®¹å™¨è§†å›¾æ§åˆ¶å™¨æœ€å¸¸ç”¨äºä¿ƒè¿›å¯¼èˆªå’ŒåŸºäºç°æœ‰å†…å®¹åˆ›å»ºæ–°çš„ç”¨æˆ·äº¤äº’ç•Œé¢ç±»å‹ã€‚UIKitä¸­å®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„ç¤ºä¾‹åŒ…æ‹¬<code>UINavigationController</code>ã€<code>UITabBarController</code>å’Œ<code>UISplitViewController</code>ï¼Œæ‰€æœ‰è¿™äº›éƒ½æœ‰åŠ©äºç”¨æˆ·äº¤äº’ç•Œé¢ä¸åŒéƒ¨åˆ†ä¹‹é—´çš„å¯¼èˆªã€‚</p> <h3 id="è®¾è®¡è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-designing-a-custom-container-view-controller"><a href="#è®¾è®¡è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-designing-a-custom-container-view-controller" class="header-anchor">#</a> è®¾è®¡è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨ ğŸŸ Designing a Custom Container View Controller</h3> <p>In almost every way, a container view controller is like any other content view controller in that it manages a root view and some content. The difference is that a container view controller gets part of its content from other view controllers. The content it gets is limited to the other view controllersâ€™ views, which it embeds inside its own view hierarchy. The container view controller sets the size and position of any embedded views, but the original view controllers still manage the content inside those views.</p> <p>åœ¨å‡ ä¹æ‰€æœ‰æ–¹é¢ï¼Œå®¹å™¨è§†å›¾æ§åˆ¶å™¨éƒ½åƒä»»ä½•å…¶ä»–å†…å®¹è§†å›¾æ§åˆ¶å™¨ä¸€æ ·ï¼Œå®ƒç®¡ç†æ ¹è§†å›¾å’Œä¸€äº›å†…å®¹ã€‚ä¸åŒä¹‹å¤„åœ¨äºå®¹å™¨è§†å›¾æ§åˆ¶å™¨ä»å…¶ä»–è§†å›¾æ§åˆ¶å™¨è·å–éƒ¨åˆ†å†…å®¹ã€‚å®ƒè·å–çš„å†…å®¹ä»…é™äºå…¶ä»–è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ï¼Œå®ƒå°†è¿™äº›è§†å›¾åµŒå…¥åˆ°è‡ªå·±çš„è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ã€‚å®¹å™¨è§†å›¾æ§åˆ¶å™¨è®¾ç½®ä»»ä½•åµŒå…¥è§†å›¾çš„å¤§å°å’Œä½ç½®ï¼Œä½†åŸå§‹è§†å›¾æ§åˆ¶å™¨ä»ç„¶ç®¡ç†è¿™äº›è§†å›¾ä¸­çš„å†…å®¹ã€‚</p> <p>When designing your own container view controllers, always understand the relationships between the container and contained view controllers. The relationships of the view controllers can help inform how their content should appear onscreen and how your container manages them internally. During the design process, ask yourself the following questions:</p> <p>åœ¨è®¾è®¡æ‚¨è‡ªå·±çš„å®¹å™¨è§†å›¾æ§åˆ¶å™¨æ—¶ï¼Œè¯·å§‹ç»ˆäº†è§£å®¹å™¨å’ŒåŒ…å«çš„è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„å…³ç³»ã€‚è§†å›¾æ§åˆ¶å™¨çš„å…³ç³»æœ‰åŠ©äºå‘ŠçŸ¥å®ƒä»¬çš„å†…å®¹åº”è¯¥å¦‚ä½•å‡ºç°åœ¨å±å¹•ä¸Šï¼Œä»¥åŠå®¹å™¨å¦‚ä½•åœ¨å†…éƒ¨ç®¡ç†å®ƒä»¬ã€‚åœ¨è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œé—®è‡ªå·±ä»¥ä¸‹é—®é¢˜ï¼š</p> <ul><li><p>What is the role of the container and what role do its children play?</p></li> <li><p>å®¹å™¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œå®ƒçš„å­ä»£æ‰®æ¼”ä»€ä¹ˆè§’è‰²ï¼Ÿ</p></li> <li><p>How many children are displayed simultaneously?</p></li> <li><p>åŒæ—¶æ˜¾ç¤ºå¤šå°‘ä¸ªå­©å­ï¼Ÿ</p></li> <li><p>What is the relationship (if any) between sibling view controllers?</p></li> <li><p>å…„å¼Ÿè§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„å…³ç³»ï¼ˆå¦‚æœæœ‰ï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</p></li> <li><p>How are child view controllers added to or removed from the container?</p></li> <li><p>å¦‚ä½•å°†å­æ§åˆ¶å™¨æ·»åŠ åˆ°å®¹å™¨ä¸­æˆ–ä»å®¹å™¨ä¸­åˆ é™¤ï¼Ÿ</p></li> <li><p>Can the size or position of the children change? Under what conditions do those changes occur?</p></li> <li><p>å­©å­çš„å¤§å°æˆ–ä½ç½®ä¼šæ”¹å˜å—ï¼Ÿè¿™äº›å˜åŒ–å‘ç”Ÿåœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Ÿ</p></li> <li><p>Does the container provide any decorative or navigation-related views of its own?</p></li> <li><p>å®¹å™¨æ§åˆ¶å™¨æ˜¯å¦æä¾›ä»»ä½•è‡ªå·±çš„è£…é¥°æˆ–å¯¼èˆªç›¸å…³è§†å›¾ï¼Ÿ</p></li> <li><p>What kind of communication is required between the container and its children? Does the container need to report specific events to its children other than the standard ones defined by the UIViewController class?</p></li> <li><p>å®¹å™¨ä¸å…¶å­çº§ä¹‹é—´éœ€è¦ä»€ä¹ˆæ ·çš„é€šä¿¡ï¼Ÿé™¤äº†<code>UIViewController</code>ç±»å®šä¹‰çš„æ ‡å‡†äº‹ä»¶ä¹‹å¤–ï¼Œå®¹å™¨æ˜¯å¦éœ€è¦å‘å…¶å­çº§æŠ¥å‘Šç‰¹å®šäº‹ä»¶ï¼Ÿ</p></li> <li><p>Can the appearance of the container be configured in different ways? If so, how?</p></li> <li><p>å®¹å™¨çš„å¤–è§‚å¯ä»¥ç”¨ä¸åŒçš„æ–¹å¼é…ç½®å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œå¦‚ä½•ï¼Ÿ</p></li></ul> <p>The implementation of a container view controller is relatively straightforward after you have defined the roles of the various objects. The only requirement from UIKit is that you establish a formal parent-child relationship between the container view controller and any child view controllers. The parent-child relationship ensures that the children receive any relevant system messages. Apart from that, most of the real work happens during the layout and management of the contained views, which is different for each container. You can place views anywhere in your containerâ€™s content area and size those views however you want. You can also add custom views to the view hierarchy to provide decoration or to aid in navigation.</p> <p>åœ¨æ‚¨å®šä¹‰äº†å„ç§å¯¹è±¡çš„è§’è‰²ä¹‹åï¼Œå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å®ç°ç›¸å¯¹ç®€å•ã€‚UIKitçš„å”¯ä¸€è¦æ±‚æ˜¯æ‚¨åœ¨å®¹å™¨è§†å›¾æ§åˆ¶å™¨å’Œä»»ä½•å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´å»ºç«‹æ­£å¼çš„çˆ¶å­å…³ç³»ã€‚çˆ¶å­å…³ç³»ç¡®ä¿å­è§†å›¾æ¥æ”¶ä»»ä½•ç›¸å…³çš„ç³»ç»Ÿæ¶ˆæ¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¤§å¤šæ•°å®é™…å·¥ä½œå‘ç”Ÿåœ¨åŒ…å«è§†å›¾çš„å¸ƒå±€å’Œç®¡ç†æœŸé—´ï¼Œè¿™å¯¹äºæ¯ä¸ªå®¹å™¨éƒ½æ˜¯ä¸åŒçš„ã€‚æ‚¨å¯ä»¥å°†è§†å›¾æ”¾ç½®åœ¨å®¹å™¨å†…å®¹åŒºåŸŸçš„ä»»ä½•ä½ç½®ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´è¿™äº›è§†å›¾çš„å¤§å°ã€‚æ‚¨è¿˜å¯ä»¥å°†è‡ªå®šä¹‰è§†å›¾æ·»åŠ åˆ°è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ï¼Œä»¥æä¾›è£…é¥°æˆ–å¸®åŠ©å¯¼èˆªã€‚</p> <h3 id="example-navigation-controller-ğŸŸ-example-navigation-controller"><a href="#example-navigation-controller-ğŸŸ-example-navigation-controller" class="header-anchor">#</a> Example: Navigation Controller ğŸŸ Example: Navigation Controller</h3> <p>A UINavigationController object supports navigation through a hierarchical data set. A navigation interface presents one child view controller at a time. A navigation bar at the top of the interface displays the current position in the data hierarchy and displays a back button to move back one level. Navigation down into the data hierarchy is left to the child view controller and can involve the use of tables or buttons.</p> <p>ä¸€ä¸ª<code>UINavigationController</code>å¯¹è±¡ç”¨äºæ”¯æŒå¯¹åˆ†å±‚çš„æ•°æ®é›†åˆè¿›è¡Œå¯¼èˆªã€‚å¯¼èˆªç•Œé¢ä¸€æ¬¡æ˜¾ç¤ºä¸€ä¸ªå­è§†å›¾æ§åˆ¶å™¨ã€‚ç•Œé¢é¡¶éƒ¨çš„å¯¼èˆªæ æ˜¾ç¤ºæ•°æ®å±‚æ¬¡ç»“æ„ä¸­çš„å½“å‰ä½ç½®ï¼Œå¹¶æ˜¾ç¤ºåé€€æŒ‰é’®ä»¥åé€€ä¸€çº§ã€‚å‘ä¸‹å¯¼èˆªåˆ°æ•°æ®å±‚æ¬¡ç»“æ„ç•™ç»™å­è§†å›¾æ§åˆ¶å™¨ï¼Œå¹¶ä¸”å¯èƒ½æ¶‰åŠä½¿ç”¨è¡¨æ ¼æˆ–æŒ‰é’®ã€‚</p> <p>Navigation between view controllers is managed jointly by the navigation controller and its children. When the user interacts with a button or table row of a child view controller, the child asks the navigation controller to push a new view controller into view. The child handles the configuration of the new view controllerâ€™s contents, but the navigation controller manages the transition animations. The navigation controller also manages the navigation bar, which displays a back button for dismissing the topmost view controller.</p> <p>è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„å¯¼èˆªç”±å¯¼èˆªæ§åˆ¶å™¨åŠå…¶å­çº§å…±åŒç®¡ç†ã€‚å½“ç”¨æˆ·ä¸å­è§†å›¾æ§åˆ¶å™¨çš„æŒ‰é’®æˆ–è¡¨è¡Œäº¤äº’æ—¶ï¼Œå­çº§è¦æ±‚å¯¼èˆªæ§åˆ¶å™¨å°†æ–°çš„è§†å›¾æ§åˆ¶å™¨æ¨é€åˆ°è§†å›¾ä¸­ã€‚å­çº§å¤„ç†æ–°è§†å›¾æ§åˆ¶å™¨å†…å®¹çš„é…ç½®ï¼Œä½†å¯¼èˆªæ§åˆ¶å™¨ç®¡ç†è¿‡æ¸¡åŠ¨ç”»ã€‚å¯¼èˆªæ§åˆ¶å™¨è¿˜ç®¡ç†å¯¼èˆªæ ï¼Œè¯¥å¯¼èˆªæ æ˜¾ç¤ºç”¨äºå…³é—­æœ€é¡¶éƒ¨è§†å›¾æ§åˆ¶å™¨çš„åé€€æŒ‰é’®ã€‚</p> <p>Figure 5-1 shows the structure of a navigation controller and its views. Most of the content area is filled by the topmost child view controller and only a small portion is occupied by the navigation bar.</p> <p>å›¾5-1 æ˜¾ç¤ºäº†å¯¼èˆªæ§åˆ¶å™¨åŠå…¶è§†å›¾çš„ç»“æ„ã€‚å¤§éƒ¨åˆ†å†…å®¹åŒºåŸŸç”±æœ€é¡¶å±‚çš„å­è§†å›¾æ§åˆ¶å™¨å¡«å……ï¼Œåªæœ‰ä¸€å°éƒ¨åˆ†è¢«å¯¼èˆªæ å ç”¨ã€‚</p> <p>Figure 5-1 Structure of a navigation interface</p> <p>å›¾5-1 å¯¼èˆªç•Œé¢çš„ç»“æ„</p> <p><img src="/static_page/assets/img/VCPG_structure-of-navigation-interface_5-1_2x.d5d58b4f.png" alt=""></p> <p>In both compact and regular environments, a navigation controller displays only one child view controller at a time. The navigation controller resizes its child to fit the available space.</p> <p>åœ¨<code>compact(ç´§å‡‘)</code>å’Œ<code>regular(å¸¸è§„)</code>ç¯å¢ƒä¸­ï¼Œå¯¼èˆªæ§åˆ¶å™¨ä¸€æ¬¡åªæ˜¾ç¤ºä¸€ä¸ªå­è§†å›¾æ§åˆ¶å™¨ã€‚å¯¼èˆªæ§åˆ¶å™¨è°ƒæ•´å…¶å­è§†å›¾æ§åˆ¶å™¨çš„å¤§å°ä»¥é€‚åº”å¯ç”¨ç©ºé—´ã€‚</p> <h3 id="example-split-view-controller-ğŸŸ-example-split-view-controller"><a href="#example-split-view-controller-ğŸŸ-example-split-view-controller" class="header-anchor">#</a> Example: Split View Controller ğŸŸ Example: Split View Controller</h3> <p>A UISplitViewController object displays the content of two view controllers in a master-detail arrangement. In this arrangement, the content of one view controller (the master) determines what details are displayed by the other view controller. The visibility of the two view controllers is configurable but is also governed by the current environment. In a regularly horizontal environment, the split view controller can show both child view controllers side-by-side or it can hide the master and display it as needed. In a compact environment, the split view controller displays only one view controller at a time.</p> <p>ä¸€ä¸ª<code>UISplitViewController</code>å¯¹è±¡ä»¥<code>master-details</code>æ’åˆ—æ˜¾ç¤ºä¸¤ä¸ªè§†å›¾æ§åˆ¶å™¨çš„å†…å®¹ã€‚åœ¨è¿™ç§æ’åˆ—ä¸­ï¼Œä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼ˆmasterï¼‰çš„å†…å®¹å†³å®šäº†å¦ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨æ˜¾ç¤ºå“ªäº›ç»†èŠ‚ã€‚ä¸¤ä¸ªè§†å›¾æ§åˆ¶å™¨çš„å¯è§æ€§æ˜¯å¯é…ç½®çš„ï¼Œä½†ä¹Ÿå—å½“å‰ç¯å¢ƒçš„æ”¯é…ã€‚åœ¨<code>regular</code>æ°´å¹³ç¯å¢ƒä¸­ï¼Œ<code>split view controller</code>å¯ä»¥å¹¶æ’æ˜¾ç¤ºä¸¤ä¸ªå­è§†å›¾æ§åˆ¶å™¨ï¼Œä¹Ÿå¯ä»¥éšè—ä¸»è§†å›¾å¹¶æ ¹æ®éœ€è¦æ˜¾ç¤ºã€‚åœ¨<code>compact</code>ç¯å¢ƒä¸­ï¼Œ<code>split view controller</code>ä¸€æ¬¡åªæ˜¾ç¤ºä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ã€‚</p> <p>Figure 5-2 shows the structure of a split view interface and its views in a regularly horizontal environment. The split view controller itself has only its container view by default. In this example, the two child views are displayed side-by-side. The size of the child views is configurable, as is the visibility of the master view.</p> <p>å›¾5-2 æ˜¾ç¤ºäº†ä¸€ä¸ªæ‹†åˆ†è§†å›¾ç•Œé¢åŠå…¶è§†å›¾åœ¨è§„åˆ™æ°´å¹³ç¯å¢ƒä¸­çš„ç»“æ„ï¼Œ<code>split view controller</code>æœ¬èº«é»˜è®¤åªæœ‰å®ƒçš„å®¹å™¨è§†å›¾ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä¸¤ä¸ªå­è§†å›¾å¹¶æ’æ˜¾ç¤ºï¼Œå­è§†å›¾çš„å¤§å°æ˜¯å¯é…ç½®çš„ï¼Œä¸»è§†å›¾çš„å¯è§æ€§ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p> <p>Figure 5-2A split view interface</p> <p>å›¾5-2A æ‹†åˆ†è§†å›¾ç•Œé¢</p> <p><img src="/static_page/assets/img/VCPG-split-view-inerface_5-2_2x.5bdbb680.png" alt=""></p> <h3 id="åœ¨interface-builderä¸­é…ç½®å®¹å™¨-ğŸŸ-configuring-a-container-in-interface-builder"><a href="#åœ¨interface-builderä¸­é…ç½®å®¹å™¨-ğŸŸ-configuring-a-container-in-interface-builder" class="header-anchor">#</a> åœ¨Interface Builderä¸­é…ç½®å®¹å™¨ ğŸŸ Configuring a Container in Interface Builder</h3> <p>To create a parent-child container relationship at design time, add a container view object to your storyboard scene, as shown in Figure 5-3. A container view object is a placeholder object that represents the contents of a child view controller. Use that view to size and position the childâ€™s root view in relation to the other views in the container.</p> <p>è¦åœ¨è®¾è®¡æ—¶åˆ›å»ºçˆ¶å­å®¹å™¨å…³ç³»ï¼Œè¯·å°†å®¹å™¨è§†å›¾å¯¹è±¡æ·»åŠ åˆ°æ•…äº‹æ¿åœºæ™¯ä¸­ï¼Œå¦‚å›¾5-3æ‰€ç¤ºã€‚å®¹å™¨è§†å›¾å¯¹è±¡æ˜¯è¡¨ç¤ºå­è§†å›¾æ§åˆ¶å™¨å†…å®¹çš„<code>placeholder</code>å¯¹è±¡ã€‚ä½¿ç”¨è¯¥è§†å›¾ç›¸å¯¹äºå®¹å™¨ä¸­çš„å…¶ä»–è§†å›¾è°ƒæ•´å­è§†å›¾çš„å¤§å°å’Œä½ç½®ã€‚</p> <p>Figure 5-3Adding a container view in Interface Builder</p> <p>å›¾5-3 åœ¨<code>Interface Builder</code>ä¸­æ·»åŠ å®¹å™¨è§†å›¾</p> <p><img src="/static_page/assets/img/container_view_embed_2x.ff0e0111.png" alt=""></p> <p>When you load a view controller with one or more container views, Interface Builder also loads the child view controllers associated with those views. The children must be instantiated at the same time as the parent so that the appropriate parent-child relationships can be created.</p> <p>å½“æ‚¨åŠ è½½ä¸€ä¸ªå®¹å™¨è§†å›¾æ§åˆ¶(åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨çš„è§†å›¾)ï¼Œ<code>Interface Builder</code>è¿˜ä¼šåŠ è½½ä¸è¿™äº›è§†å›¾å…³è”çš„å­è§†å›¾æ§åˆ¶å™¨ã€‚å­è§†å›¾å¿…é¡»ä¸çˆ¶è§†å›¾<strong>åŒæ—¶</strong>å®ä¾‹åŒ–ï¼Œä»¥ä¾¿å¯ä»¥åˆ›å»ºé€‚å½“çš„çˆ¶å­å…³ç³»ã€‚</p> <p>If you do not use Interface Builder to set up your parent-child container relationships, you must create those relationships programmatically by adding each child to the container view controller, as described in Adding a Child View Controller to Your Content.</p> <p>å¦‚æœä¸ä½¿ç”¨<code>Interface Builder</code>è®¾ç½®çˆ¶å­å®¹å™¨å…³ç³»ï¼Œåˆ™å¿…é¡»é€šè¿‡å°†æ¯ä¸ªå­å®¹å™¨æ·»åŠ åˆ°å®¹å™¨è§†å›¾æ§åˆ¶å™¨é‡Œé¢ï¼Œæ¥ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºè¿™äº›å…³ç³»ï¼Œå¦‚<em>å°†å­è§†å›¾æ§åˆ¶å™¨æ·»åŠ åˆ°æ‚¨çš„å†…å®¹ä¸­</em><a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/ImplementingaContainerViewController.html#//apple_ref/doc/uid/TP40007457-CH11-SW13" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ‰€è¿°ã€‚</p> <h3 id="å®ç°è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-implementing-a-custom-container-view-controller"><a href="#å®ç°è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨-ğŸŸ-implementing-a-custom-container-view-controller" class="header-anchor">#</a> å®ç°è‡ªå®šä¹‰å®¹å™¨è§†å›¾æ§åˆ¶å™¨ ğŸŸ Implementing a Custom Container View Controller</h3> <p>To implement a container view controller, you must establish relationships between your view controller and its child view controllers. Establishing these parent-child relationships is required before you try to manage the views of any child view controllers. Doing so lets UIKit know that your view controller is managing the size and position of the children. You can create these relationships in Interface Builder or create them programmatically. When creating parent-child relationships programmatically, you explicitly add and remove child view controllers as part of your view controller setup.</p> <p>è¦å®ç°å®¹å™¨è§†å›¾æ§åˆ¶å™¨ï¼Œæ‚¨å¿…é¡»åœ¨è§†å›¾æ§åˆ¶å™¨ä¸å…¶å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´å»ºç«‹å…³ç³»ã€‚åœ¨å°è¯•ç®¡ç†ä»»ä½•å­è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ä¹‹å‰ï¼Œéœ€è¦å»ºç«‹è¿™äº›çˆ¶å­å…³ç³»ã€‚è¿™æ ·åšå¯ä»¥è®©UIKitçŸ¥é“æ‚¨çš„è§†å›¾æ§åˆ¶å™¨æ­£åœ¨ç®¡ç†å­è§†å›¾çš„å¤§å°å’Œä½ç½®ã€‚æ‚¨å¯ä»¥åœ¨Interface Builderä¸­åˆ›å»ºè¿™äº›å…³ç³»æˆ–ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºå®ƒä»¬ã€‚ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºçˆ¶å­å…³ç³»æ—¶ï¼Œæ‚¨å¯ä»¥æ˜¾å¼æ·»åŠ å’Œåˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ï¼Œä½œä¸ºè§†å›¾æ§åˆ¶å™¨è®¾ç½®çš„ä¸€éƒ¨åˆ†ã€‚</p> <h3 id="å°†å­è§†å›¾æ§åˆ¶å™¨æ·»åŠ åˆ°æ‚¨çš„å†…å®¹ä¸Š-ğŸŸ-adding-a-child-view-controller-to-your-content"><a href="#å°†å­è§†å›¾æ§åˆ¶å™¨æ·»åŠ åˆ°æ‚¨çš„å†…å®¹ä¸Š-ğŸŸ-adding-a-child-view-controller-to-your-content" class="header-anchor">#</a> å°†å­è§†å›¾æ§åˆ¶å™¨æ·»åŠ åˆ°æ‚¨çš„å†…å®¹ä¸Š ğŸŸ Adding a Child View Controller to Your Content</h3> <p>To incorporate a child view controller into your content programmatically, create a parent-child relationship between the relevant view controllers by doing the following:</p> <p>è¦ä»¥ç¼–ç¨‹æ–¹å¼å°†å­è§†å›¾æ§åˆ¶å™¨åˆå¹¶åˆ°æ‚¨çš„å†…å®¹ä¸­ï¼Œè¯·é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œåœ¨ç›¸å…³è§†å›¾æ§åˆ¶å™¨ä¹‹é—´åˆ›å»ºçˆ¶å­å…³ç³»ï¼š</p> <ol><li><p>Call the addChildViewController: method of your container view controller.</p></li> <li><p>è°ƒç”¨å®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„<code>addChildViewController:</code>æ–¹æ³•ã€‚</p> <p>This method tells UIKit that your container view controller is now managing the view of the child view controller.</p> <p>æ­¤æ–¹æ³•å‘Šè¯‰UIKitæ‚¨çš„å®¹å™¨è§†å›¾æ§åˆ¶å™¨ç°åœ¨æ­£åœ¨ç®¡ç†å­è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ã€‚</p></li> <li><p>Add the childâ€™s root view to your containerâ€™s view hierarchy.</p></li> <li><p>å°†å­è§†å›¾çš„æ ¹è§†å›¾æ·»åŠ åˆ°å®¹å™¨çš„è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ã€‚</p> <p>Always remember to set the size and position of the childâ€™s frame as part of this process.</p> <p>å§‹ç»ˆè®°ä½è®¾ç½®<code>childVC</code>çš„<code>frame</code>çš„å¤§å°å’Œä½ç½®ä½œä¸ºæ­¤æ“ä½œçš„ä¸€éƒ¨åˆ†ã€‚</p></li> <li><p>Add any constraints for managing the size and position of the childâ€™s root view.</p></li> <li><p>æ·»åŠ ç”¨äºç®¡ç†å­çº§æ ¹è§†å›¾çš„å¤§å°å’Œä½ç½®çš„ä»»ä½•çº¦æŸã€‚</p></li> <li><p>Call the didMoveToParentViewController: method of the child view controller.</p></li> <li><p>è°ƒç”¨å­è§†å›¾æ§åˆ¶å™¨çš„<code>didMoveToParentViewController:</code>æ–¹æ³•ã€‚</p></li></ol> <p>Listing 5-1 shows how a container embeds a child view controller in its container. After establishing the parent-child relationship, the container sets the frame of its child and adds the childâ€™s view to its own view hierarchy. Setting the frame size of the childâ€™s view is important and ensures that the view shows up correctly in your container. After adding the view, the container calls the childâ€™s didMoveToParentViewController: method to give the child view controller a chance to respond to the change in view ownership.</p> <p>æ¸…å•5-1æ˜¾ç¤ºäº†å®¹å™¨å¦‚ä½•åœ¨å…¶å®¹å™¨ä¸­åµŒå…¥å­è§†å›¾æ§åˆ¶å™¨ã€‚åœ¨å»ºç«‹çˆ¶å­å…³ç³»åï¼Œå®¹å™¨è®¾ç½®å…¶å­è§†å›¾çš„<code>frame</code>ï¼Œå¹¶å°†å­è§†å›¾æ·»åŠ åˆ°è‡ªå·±çš„è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ã€‚è®¾ç½®å­è§†å›¾çš„<code>frame</code>å¤§å°å¾ˆé‡è¦ï¼Œå¹¶ç¡®ä¿è§†å›¾åœ¨æ‚¨çš„å®¹å™¨ä¸­æ­£ç¡®æ˜¾ç¤ºã€‚æ·»åŠ è§†å›¾åï¼Œå®¹å™¨è°ƒç”¨å­è§†å›¾çš„<code>didMoveToParentViewController:</code>æ–¹æ³•ï¼Œè®©å­è§†å›¾æ§åˆ¶å™¨æœ‰æœºä¼šå“åº”è§†å›¾æ‰€æœ‰æƒçš„å˜åŒ–ã€‚</p> <p>Listing 5-1Adding a child view controller to a container</p> <p>ç¤ºä¾‹5-1å‘å®¹å™¨æ·»åŠ å­è§†å›¾æ§åˆ¶å™¨</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>displayContentController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>content <span class="token punctuation">{</span>
   <span class="token punctuation">[</span><span class="token keyword">self</span> addChildViewController<span class="token punctuation">:</span>content<span class="token punctuation">]</span><span class="token punctuation">;</span>
   content<span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span> frameForContentController<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>view addSubview<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>currentClientView<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">[</span>content didMoveToParentViewController<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>In the preceding example, notice that you call only the didMoveToParentViewController: method of the child. That is because the addChildViewController: method calls the childâ€™s willMoveToParentViewController: method for you. The reason that you must call the didMoveToParentViewController: method yourself is that the method cannot be called until after you embed the childâ€™s view into your containerâ€™s view hierarchy.</p> <p>åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œè¯·æ³¨æ„ï¼Œæ‚¨åªè°ƒç”¨äº†å­æ§åˆ¶å™¨çš„<code>didMoveToParentViewController:</code>æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸º<code>addChildViewController:</code>æ–¹æ³•ä¸ºæ‚¨è°ƒç”¨äº†å­è§†å›¾çš„<code>willMoveToParentViewController:</code>æ–¹æ³•ã€‚æ‚¨å¿…é¡»è‡ªå·±è°ƒç”¨<code>didMoveToParentViewController:</code>æ–¹æ³•çš„åŸå› æ˜¯ï¼Œåœ¨æ‚¨å°†å­è§†å›¾åµŒå…¥åˆ°å®¹å™¨çš„è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ä¹‹å‰ï¼Œä¸èƒ½è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p> <p>When using Auto Layout, set up constraints between the container and child after adding the child to the containerâ€™s view hierarchy. Your constraints should affect the size and position of only the childâ€™s root view. Do not alter the contents of the root view or any other views in the childâ€™s view hierarchy.</p> <p>ä½¿ç”¨è‡ªåŠ¨å¸ƒå±€æ—¶ï¼Œåœ¨å°†å­è§†å›¾æ·»åŠ åˆ°å®¹å™¨çš„è§†å›¾å±‚æ¬¡ç»“æ„åï¼Œåœ¨å®¹å™¨å’Œå­è§†å›¾ä¹‹é—´è®¾ç½®çº¦æŸã€‚æ‚¨çš„çº¦æŸåº”è¯¥åªå½±å“å­è§†å›¾çš„æ ¹è§†å›¾çš„å¤§å°å’Œä½ç½®ã€‚ä¸è¦æ›´æ”¹æ ¹è§†å›¾æˆ–å­è§†å›¾å±‚æ¬¡ç»“æ„ä¸­çš„ä»»ä½•å…¶ä»–è§†å›¾çš„å†…å®¹ã€‚</p> <h3 id="åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨-ğŸŸ-removing-a-child-view-controller"><a href="#åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨-ğŸŸ-removing-a-child-view-controller" class="header-anchor">#</a> åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ ğŸŸ Removing a Child View Controller</h3> <p>To remove a child view controller from your content, remove the parent-child relationship between the view controllers by doing the following:</p> <p>è¦ä»å†…å®¹ä¸­åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ï¼Œè¯·é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œåˆ é™¤è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»ï¼š</p> <ol><li><p>Call the childâ€™s willMoveToParentViewController: method with the value nil.</p></li> <li><p>è°ƒç”¨å­©å­çš„<code>willMoveToParentViewController:</code>æ–¹æ³•ï¼Œå€¼ä¸º<code>nil</code>ã€‚</p></li> <li><p>Remove any constraints that you configured with the childâ€™s root view.</p></li> <li><p>åˆ é™¤æ‚¨ä½¿ç”¨å­è§†å›¾çš„æ ¹è§†å›¾é…ç½®çš„ä»»ä½•çº¦æŸã€‚</p></li> <li><p>Remove the childâ€™s root view from your containerâ€™s view hierarchy.</p></li> <li><p>ä»å®¹å™¨çš„è§†å›¾å±‚æ¬¡ç»“æ„ä¸­åˆ é™¤å­è§†å›¾çš„æ ¹è§†å›¾ã€‚</p></li> <li><p>Call the childâ€™s removeFromParentViewController method to finalize the end of the parent-child relationship.</p></li> <li><p>è°ƒç”¨å­çº§çš„<code>removeFromParentViewController</code>æ–¹æ³•æ¥å®Œæˆçˆ¶å­å…³ç³»çš„ç»“æŸã€‚</p></li></ol> <p>Removing a child view controller permanently severs the relationship between parent and child. Remove a child view controller only when you no longer need to refer to it. For example, a navigation controller does not remove its current child view controllers when a new one is pushed onto the navigation stack. It removes them only when they are popped off the stack.</p> <p>åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ä¼šæ°¸ä¹…åˆ‡æ–­çˆ¶è§†å›¾æ§åˆ¶å™¨ä¸å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„å…³ç³»ã€‚ä»…å½“ä¸å†éœ€è¦å¼•ç”¨å­è§†å›¾æ§åˆ¶å™¨æ—¶æ‰åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ–°çš„å­è§†å›¾æ§åˆ¶å™¨è¢«å‹å…¥å¯¼èˆªå †æ ˆæ—¶ï¼Œå¯¼èˆªæ§åˆ¶å™¨ä¸ä¼šåˆ é™¤å…¶å½“å‰çš„å­è§†å›¾æ§åˆ¶å™¨ã€‚åªæœ‰å½“å®ƒä»¬ä»å †æ ˆä¸­å¼¹å‡ºæ—¶ï¼Œå®ƒæ‰ä¼šåˆ é™¤å®ƒä»¬ã€‚</p> <p>Listing 5-2 shows you how to remove a child view controller from its container. Calling the willMoveToParentViewController: method with the value nil gives the child view controller an opportunity to prepare for the change. The removeFromParentViewController method also calls the childâ€™s didMoveToParentViewController: method, passing that method a value of nil. Setting the parent view controller to nil finalizes the removal of the childâ€™s view from your container.</p> <p>æ¸…å•5-2å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•ä»å­è§†å›¾æ§åˆ¶å™¨çš„å®¹å™¨ä¸­åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ã€‚è°ƒç”¨<code>willMoveToParentViewController:</code>æ–¹æ³•æ—¶ï¼Œå€¼ä¸º<code>nil</code>ï¼Œå­è§†å›¾æ§åˆ¶å™¨å°±æœ‰æœºä¼šä¸ºæ›´æ”¹åšå‡†å¤‡ã€‚<code>removeFromParentViewController</code>æ–¹æ³•è¿˜è°ƒç”¨å­è§†å›¾çš„<code>didMoveToParentViewController:</code>æ–¹æ³•ï¼Œå¹¶å°†å€¼nilçš„å€¼ä¼ é€’ç»™è¯¥æ–¹æ³•ã€‚å°†çˆ¶è§†å›¾æ§åˆ¶å™¨è®¾ç½®ä¸ºnilï¼Œå°±å®Œæˆäº†ä»å®¹å™¨ä¸­åˆ é™¤å­è§†å›¾çš„æ“ä½œã€‚</p> <p>Listing 5-2Removing a child view controller from a container</p> <p>ç¤ºä¾‹5-2ä»å®¹å™¨ä¸­åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>hideContentController<span class="token punctuation">:</span><span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>content <span class="token punctuation">{</span>
   <span class="token punctuation">[</span>content willMoveToParentViewController<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">[</span>content<span class="token punctuation">.</span>view removeFromSuperview<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">[</span>content removeFromParentViewController<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„è½¬æ¢-ğŸŸ-transitioning-between-child-view-controllers"><a href="#å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„è½¬æ¢-ğŸŸ-transitioning-between-child-view-controllers" class="header-anchor">#</a> å­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„è½¬æ¢ ğŸŸ Transitioning Between Child View Controllers</h3> <p>When you want to animate the replacement of one child view controller with another, incorporate the addition and removal of the child view controllers into the transition animation process. Before the animations, make sure both child view controllers are part of your content but let the current child know that it is about to go away. During your animations, move the new childâ€™s view into position and remove the old childâ€™s view. At the completion of the animation, complete the removal of the child view controller.</p> <p>å½“æ‚¨æƒ³ç”¨å¦ä¸€ä¸ªå­è§†å›¾æ§åˆ¶å™¨æ›¿æ¢æ—¶ï¼Œå°†å­è§†å›¾æ§åˆ¶å™¨çš„æ·»åŠ å’Œåˆ é™¤åˆå¹¶åˆ°è¿‡æ¸¡åŠ¨ç”»è¿‡ç¨‹ä¸­ã€‚åœ¨åŠ¨ç”»ä¹‹å‰ï¼Œç¡®ä¿ä¸¤ä¸ªå­è§†å›¾æ§åˆ¶å™¨éƒ½æ˜¯æ‚¨å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œä½†è®©å½“å‰å­è§†å›¾çŸ¥é“å®ƒå³å°†æ¶ˆå¤±ã€‚åœ¨åŠ¨ç”»æœŸé—´ï¼Œå°†æ–°å­è§†å›¾ç§»åŠ¨åˆ°é€‚å½“çš„ä½ç½®å¹¶åˆ é™¤æ—§å­è§†å›¾ã€‚åŠ¨ç”»å®Œæˆæ—¶ï¼Œå®Œæˆå­è§†å›¾æ§åˆ¶å™¨çš„åˆ é™¤ã€‚</p> <p>Listing 5-3 shows an example of how to swap one child view controller for another using a transition animation. In this example, the new view controller is animated to the rectangle currently occupied by the existing child view controller, which is moved offscreen. After the animations finish, the completion block removes the child view controller from the container. In this example, the transitionFromViewController:toViewController:duration:options:animations:completion: method automatically updates the containerâ€™s view hierarchy, so you do not need to add and remove the views yourself.</p> <p>æ¸…å•5-3æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¿‡æ¸¡åŠ¨ç”»å°†ä¸€ä¸ªå­è§†å›¾æ§åˆ¶å™¨è½¬æ¢ä¸ºå¦ä¸€ä¸ªå­è§†å›¾æ§åˆ¶å™¨çš„ç¤ºä¾‹ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæ–°çš„è§†å›¾æ§åˆ¶å™¨è¢«åŠ¨ç”»ç§»åŠ¨åˆ°ä¸ºç°æœ‰å­è§†å›¾æ§åˆ¶å™¨å½“å‰å ç”¨çš„çŸ©å½¢åŒºåŸŸï¼Œè¯¥çŸ©å½¢è¢«ç§»å‡ºå±å¹•ã€‚åŠ¨ç”»å®Œæˆåï¼Œåœ¨<code>completion block</code>ä¸­ä»å®¹å™¨ä¸­åˆ é™¤å­è§†å›¾æ§åˆ¶å™¨ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>transitionFromViewController:toViewController:duration:options:animations:completion:</code>æ–¹æ³•ä¼šè‡ªåŠ¨æ›´æ–°å®¹å™¨çš„è§†å›¾å±‚æ¬¡ç»“æ„ï¼Œå› æ­¤æ‚¨ä¸éœ€è¦è‡ªå·±æ·»åŠ å’Œåˆ é™¤è§†å›¾ã€‚</p> <p>Listing 5-3Transitioning between two child view controllers</p> <p>æ¸…å•5-3ä¸¤ä¸ªå­è§†å›¾æ§åˆ¶å™¨ä¹‹é—´çš„è½¬æ¢</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>cycleFromViewController<span class="token punctuation">:</span> <span class="token punctuation">(</span>UIViewController<span class="token operator">*</span><span class="token punctuation">)</span> oldVC
               toViewController<span class="token punctuation">:</span> <span class="token punctuation">(</span>UIViewController<span class="token operator">*</span><span class="token punctuation">)</span> newVC <span class="token punctuation">{</span>
   <span class="token comment">// Prepare the two view controllers for the change.</span>
   <span class="token punctuation">[</span>oldVC willMoveToParentViewController<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">[</span><span class="token keyword">self</span> addChildViewController<span class="token punctuation">:</span>newVC<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token comment">// Get the start frame of the new view controller and the end frame</span>
   <span class="token comment">// for the old view controller. Both rectangles are offscreen.</span>
   newVC<span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span> newViewStartFrame<span class="token punctuation">]</span><span class="token punctuation">;</span>
   CGRect endFrame <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span> oldViewEndFrame<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token comment">// Queue up the transition animation.</span>
   <span class="token punctuation">[</span><span class="token keyword">self</span> transitionFromViewController<span class="token punctuation">:</span> oldVC toViewController<span class="token punctuation">:</span> newVC
        duration<span class="token punctuation">:</span> <span class="token number">0.25</span> options<span class="token punctuation">:</span><span class="token number">0</span>
        animations<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
            <span class="token comment">// Animate the views to their final positions.</span>
            newVC<span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame <span class="token operator">=</span> oldVC<span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame<span class="token punctuation">;</span>
            oldVC<span class="token punctuation">.</span>view<span class="token punctuation">.</span>frame <span class="token operator">=</span> endFrame<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        completion<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>BOOL finished<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token comment">// Remove the old view controller and send the final</span>
           <span class="token comment">// notification to the new view controller.</span>
           <span class="token punctuation">[</span>oldVC removeFromParentViewController<span class="token punctuation">]</span><span class="token punctuation">;</span>
           <span class="token punctuation">[</span>newVC didMoveToParentViewController<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="ç®¡ç†å­vcçš„å¤–è§‚æ›´æ–°-ğŸŸ-managing-appearance-updates-for-children"><a href="#ç®¡ç†å­vcçš„å¤–è§‚æ›´æ–°-ğŸŸ-managing-appearance-updates-for-children" class="header-anchor">#</a> ç®¡ç†å­VCçš„å¤–è§‚æ›´æ–° ğŸŸ Managing Appearance Updates for Children</h3> <p>After adding a child to a container, the container automatically forwards appearance-related messages to the child. This is normally the behavior you want, because it ensures that all events are properly sent. However, sometimes the default behavior may send those events in an order that doesnâ€™t make sense for your container. For example, if multiple children are simultaneously changing their view state, you may want to consolidate the changes so that the appearance callbacks all happen at the same time in a more logical order.</p> <p>å°†å­VCæ·»åŠ åˆ°å®¹å™¨åï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å°†å¤–è§‚ç›¸å…³æ¶ˆæ¯è½¬å‘ç»™å­çº§ã€‚è¿™é€šå¸¸æ˜¯æ‚¨æƒ³è¦çš„è¡Œä¸ºï¼Œå› ä¸ºå®ƒç¡®ä¿æ‰€æœ‰äº‹ä»¶éƒ½æ­£ç¡®å‘é€ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶é»˜è®¤è¡Œä¸ºå¯èƒ½ä¼šä»¥å¯¹æ‚¨çš„å®¹å™¨æ²¡æœ‰æ„ä¹‰çš„é¡ºåºå‘é€è¿™äº›äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¤šä¸ªå­çº§åŒæ—¶æ›´æ”¹å…¶è§†å›¾çŠ¶æ€ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åˆå¹¶æ›´æ”¹ï¼Œä»¥ä¾¿å¤–è§‚å›è°ƒä»¥æ›´åˆä¹é€»è¾‘çš„é¡ºåºåŒæ—¶å‘ç”Ÿã€‚</p> <p>To take over responsibility for appearance callbacks, override the shouldAutomaticallyForwardAppearanceMethods method in your container view controller and return NO, as shown in Listing 5-4. Returning NO lets UIKit know that your container view controller notifies its children of changes in its appearance.</p> <p>è¦æ¥ç®¡å¤–è§‚å›è°ƒçš„è´£ä»»ï¼Œè¯·é‡å†™å®¹å™¨è§†å›¾æ§åˆ¶å™¨ä¸­çš„<code>shouldAutomaticallyForwardAppearanceMethods</code>å¹¶è¿”å›NOï¼Œå¦‚æ¸…å•5-4æ‰€ç¤ºã€‚è¿”å›NOå¯ä»¥è®©UIKitçŸ¥é“å®¹å™¨è§†å›¾æ§åˆ¶å™¨é€šçŸ¥å…¶å­çº§å¤–è§‚æ›´æ”¹ã€‚</p> <p>Listing 5-4Disabling automatic appearance forwarding</p> <p>ç¤ºä¾‹5-4ç¦ç”¨è‡ªåŠ¨å¤–è§‚è½¬å‘</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span> shouldAutomaticallyForwardAppearanceMethods <span class="token punctuation">{</span>
    <span class="token keyword">return</span> NO<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>When an appearance transition occurs, call the childâ€™s beginAppearanceTransition:animated: or endAppearanceTransition method as appropriate. For example, if your container has a single child referenced by a child property, your container would forward these messages to the child as shown in Listing 5-5.</p> <p>å½“å‘ç”Ÿå¤–è§‚è½¬æ¢æ—¶ï¼Œè°ƒç”¨å­çº§çš„<code>beginAppearanceTransition:animated:</code>æˆ–<code>endAppearanceTransition</code>æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å®¹å™¨æœ‰ä¸€ä¸ªç”±childå±æ€§å¼•ç”¨çš„å­çº§ï¼Œæ‚¨çš„å®¹å™¨ä¼šå°†è¿™äº›æ¶ˆæ¯è½¬å‘ç»™è¯¥å­çº§ï¼Œå¦‚æ¸…å•5-5æ‰€ç¤ºã€‚</p> <p>Listing 5-5Forwarding appearance messages when the container appears or disappears</p> <p>ç¤ºä¾‹5-5åœ¨å®¹å™¨å‡ºç°æˆ–æ¶ˆå¤±æ—¶è½¬å‘å¤–è§‚æ¶ˆæ¯</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> viewWillAppear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>child beginAppearanceTransition<span class="token punctuation">:</span> YES animated<span class="token punctuation">:</span> animated<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> viewDidAppear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>child endAppearanceTransition<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> viewWillDisappear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>child beginAppearanceTransition<span class="token punctuation">:</span> NO animated<span class="token punctuation">:</span> animated<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> viewDidDisappear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>child endAppearanceTransition<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="å…³äºæ„å»ºå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å»ºè®®-ğŸŸ-suggestions-for-building-a-container-view-controller"><a href="#å…³äºæ„å»ºå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å»ºè®®-ğŸŸ-suggestions-for-building-a-container-view-controller" class="header-anchor">#</a> å…³äºæ„å»ºå®¹å™¨è§†å›¾æ§åˆ¶å™¨çš„å»ºè®® ğŸŸ Suggestions for Building a Container View Controller</h3> <p>Designing, developing, and testing a new container view controller takes time. Although the individual behaviors are straightforward, the controller as a whole can be quite complex. Consider the following tips when implementing your own container classes:</p> <p>è®¾è®¡ã€å¼€å‘å’Œæµ‹è¯•æ–°çš„å®¹å™¨è§†å›¾æ§åˆ¶å™¨éœ€è¦æ—¶é—´ã€‚å°½ç®¡å•ä¸ªè¡Œä¸ºå¾ˆç®€å•ï¼Œä½†æ§åˆ¶å™¨ä½œä¸ºä¸€ä¸ªæ•´ä½“å¯èƒ½ç›¸å½“å¤æ‚ã€‚åœ¨å®ç°è‡ªå·±çš„å®¹å™¨ç±»æ—¶ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹æç¤ºï¼š</p> <ul><li><p>Access only the root view of a child view controller. A container should access only the root view of each childâ€”that is, the view returned by the childâ€™s view property. It should never access any of the childâ€™s other views.</p></li> <li><p><strong>åªè®¿é—®å­è§†å›¾æ§åˆ¶å™¨çš„æ ¹è§†å›¾</strong>ã€‚å®¹å™¨åº”è¯¥åªè®¿é—®æ¯ä¸ªå­è§†å›¾çš„æ ¹è§†å›¾â€”â€”å³å­è§†å›¾å±æ€§è¿”å›çš„viewã€‚å®ƒæ°¸è¿œä¸åº”è¯¥è®¿é—®å­è§†å›¾çš„ä»»ä½•å…¶ä»–è§†å›¾ã€‚</p></li> <li><p>Child view controllers should have minimal knowledge of their container. A child view controller should focus on its own content. If the container allows its behavior to be influenced by a child, it should use the delegation design pattern to manage those interactions.</p></li> <li><p><strong>å­è§†å›¾æ§åˆ¶å™¨åº”è¯¥å¯¹å…¶å®¹å™¨æœ‰æœ€å°‘çš„äº†è§£</strong>ã€‚å­è§†å›¾æ§åˆ¶å™¨åº”è¯¥ä¸“æ³¨äºå®ƒè‡ªå·±çš„å†…å®¹ã€‚å¦‚æœå®¹å™¨å…è®¸å®ƒçš„è¡Œä¸ºå—åˆ°å­å®¹å™¨çš„å½±å“ï¼Œå®ƒåº”è¯¥ä½¿ç”¨å§”æ‰˜è®¾è®¡æ¨¡å¼æ¥ç®¡ç†è¿™äº›äº¤äº’ã€‚</p></li> <li><p>Design your container using regular views first. Using regular views (instead of the views from child view controllers) gives you an opportunity to test layout constraints and animated transitions in a simplified environment. When the regular views work as expected, swap them out for the views of your child view controllers.</p></li> <li><p><strong>é¦–å…ˆä½¿ç”¨å¸¸è§„è§†å›¾è®¾è®¡å®¹å™¨</strong>ã€‚ä½¿ç”¨å¸¸è§„è§†å›¾ï¼ˆè€Œä¸æ˜¯æ¥è‡ªå­è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ï¼‰ä½¿æ‚¨æœ‰æœºä¼šåœ¨ç®€åŒ–çš„ç¯å¢ƒä¸­æµ‹è¯•å¸ƒå±€çº¦æŸå’ŒåŠ¨ç”»è½¬æ¢ã€‚å½“å¸¸è§„è§†å›¾æŒ‰é¢„æœŸå·¥ä½œæ—¶ï¼Œå°†å®ƒä»¬äº¤æ¢ä¸ºå­è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ã€‚</p></li></ul> <h3 id="å°†æ§åˆ¶å§”æ‰˜ç»™å­è§†å›¾æ§åˆ¶å™¨-ğŸŸ-delegating-control-to-a-child-view-controller"><a href="#å°†æ§åˆ¶å§”æ‰˜ç»™å­è§†å›¾æ§åˆ¶å™¨-ğŸŸ-delegating-control-to-a-child-view-controller" class="header-anchor">#</a> å°†æ§åˆ¶å§”æ‰˜ç»™å­è§†å›¾æ§åˆ¶å™¨ ğŸŸ Delegating Control to a Child View Controller</h3> <p>A container view controller can delegate some aspects of its own appearance to one or more of its children. You can delegate control in the following ways:</p> <p>å®¹å™¨è§†å›¾æ§åˆ¶å™¨å¯ä»¥å°†å…¶è‡ªèº«å¤–è§‚çš„æŸäº›æ–¹é¢å§”æ‰˜ç»™å®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­çº§ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å§”æ‰˜æ§åˆ¶ï¼š</p> <ul><li><p>Let a child view controller determine the status bar style. To delegate the status bar appearance to a child, override one or both of the childViewControllerForStatusBarStyle and childViewControllerForStatusBarHidden methods in your container view controller.</p></li> <li><p><strong>è®©å­è§†å›¾æ§åˆ¶å™¨ç¡®å®šçŠ¶æ€æ æ ·å¼</strong>ã€‚è¦å°†çŠ¶æ€æ å¤–è§‚å§”æ‰˜ç»™å­è§†å›¾æ§åˆ¶å™¨ï¼Œè¯·è¦†ç›–å®¹å™¨è§†å›¾æ§åˆ¶å™¨ä¸­çš„<code>childViewControllerForStatusBarStyle</code>å’Œ<code>childViewControllerForStatusBarHidden</code>æ–¹æ³•ä¸­çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªã€‚</p></li></ul> <p>Let the child specify its own preferred size. A container with a flexible layout can use the childâ€™s own preferredContentSize property to help determine the size of the child.</p> <ul><li><strong>è®©å­è§†å›¾æ§åˆ¶å™¨æŒ‡å®šè‡ªå·±çš„é¦–é€‰å¤§å°</strong>ã€‚å…·æœ‰çµæ´»å¸ƒå±€çš„å®¹å™¨å¯ä»¥ä½¿ç”¨å­VCè‡ªå·±çš„<code>preferredContentSize</code>å±æ€§æ¥å¸®åŠ©ç¡®å®šå­VCçš„å¤§å°ã€‚</li></ul> <h2 id="_3-æ”¯æŒæ— éšœç¢-ğŸŸ-supporting-accessibility"><a href="#_3-æ”¯æŒæ— éšœç¢-ğŸŸ-supporting-accessibility" class="header-anchor">#</a> 3. æ”¯æŒæ— éšœç¢ ğŸŸ Supporting Accessibility</h2> <p>An accessible app is one that can be used by everyoneâ€”including those with a disability or physical impairmentâ€”while retaining its functionality and usability as a helpful tool. To be accessible, an iOS app must supply information about its user interface elements to VoiceOver, so that vision-impaired users can interact with those elements. UIKit objects are accessible by default, but there are still things you can do from the view controllerâ€™s perspective to address accessibility, including the following:</p> <p>æ— éšœç¢appæ˜¯æŒ‡æ¯ä¸ªäººéƒ½å¯ä»¥ä½¿ç”¨çš„åº”ç”¨ç¨‹åºâ€”â€”åŒ…æ‹¬æ®‹ç–¾äººæˆ–èº«ä½“éšœç¢è€…â€”â€”åŒæ—¶ä¿ç•™å…¶åŠŸèƒ½å’Œå¯ç”¨æ€§ä½œä¸ºæœ‰ç”¨å·¥å…·ã€‚ä¸ºäº†ä¾¿äºæ— éšœç¢ä½¿ç”¨ï¼ŒiOSåº”ç”¨ç¨‹åºå¿…é¡»å‘<code>Voiceover</code>æä¾›æœ‰å…³å…¶ç”¨æˆ·äº¤äº’ç•Œé¢å…ƒç´ çš„ä¿¡æ¯ï¼Œä»¥ä¾¿è§†åŠ›å—æŸçš„ç”¨æˆ·å¯ä»¥ä¸è¿™äº›å…ƒç´ è¿›è¡Œäº¤äº’ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒUIKitå®šä¹‰çš„å¯¹è±¡æ˜¯å¯è®¿é—®çš„ï¼Œä½†ä»è§†å›¾æ§åˆ¶å™¨çš„è§’åº¦æ¥çœ‹ï¼Œæ‚¨ä»ç„¶å¯ä»¥åšä¸€äº›äº‹æƒ…æ¥è§£å†³å¯è®¿é—®æ€§é—®é¢˜ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š</p> <ul><li><p>Ensure that every user element in your interface is accessible, including controls and static elements such as labels.</p></li> <li><p>ç¡®ä¿ç•Œé¢ä¸­çš„æ¯ä¸ªç”¨æˆ·å…ƒç´ éƒ½æ˜¯æ”¯æŒæ— éšœç¢çš„ï¼ŒåŒ…æ‹¬æ§ä»¶å’Œæ ‡ç­¾ç­‰é™æ€å…ƒç´ ã€‚</p></li> <li><p>Ensure that accessible elements supply accurate and helpful information.</p></li> <li><p>ç¡®ä¿æ— éšœç¢çš„å…ƒç´ æä¾›å‡†ç¡®å’Œæœ‰ç”¨çš„ä¿¡æ¯ã€‚</p></li></ul> <p>You can enhance the VoiceOver userâ€™s experience in your app by setting the position of the VoiceOver focus ring programmatically, by responding to special VoiceOver gestures, and by observing accessibility notifications.</p> <p>æ‚¨å¯ä»¥é€šè¿‡ä»¥ç¼–ç¨‹æ–¹å¼è®¾ç½®<code>Voiceover</code>ç„¦ç‚¹ç¯çš„ä½ç½®ã€å“åº”ç‰¹æ®Šçš„<code>Voiceover</code>æ‰‹åŠ¿ä»¥åŠç›‘å¬æ— éšœç¢é€šçŸ¥æ¥å¢å¼º<code>Voiceover</code>ç”¨æˆ·åœ¨æ‚¨çš„åº”ç”¨ä¸­çš„ä½“éªŒã€‚</p> <h3 id="å°†voiceover-ç”»å¤–éŸ³-å…‰æ ‡ç§»åŠ¨åˆ°ç‰¹å®šå…ƒç´ -ğŸŸ-moving-the-voiceover-cursor-to-a-specific-element"><a href="#å°†voiceover-ç”»å¤–éŸ³-å…‰æ ‡ç§»åŠ¨åˆ°ç‰¹å®šå…ƒç´ -ğŸŸ-moving-the-voiceover-cursor-to-a-specific-element" class="header-anchor">#</a> å°†<code>VoiceOver</code>(ç”»å¤–éŸ³)å…‰æ ‡ç§»åŠ¨åˆ°ç‰¹å®šå…ƒç´  ğŸŸ Moving the VoiceOver Cursor to a Specific Element</h3> <p>When your app presents new views onscreen, consider setting the position of the VoiceOver cursor. When the layout of a screen changes, the VoiceOver focus ring, also known as the VoiceOver cursor, resets its position to the first element displayed on the screen from left to right and top to bottom. Placing the cursor over a more appropriate element can speed the userâ€™s navigation of your interface. For example, when pushing a new view controller onto a navigation controllerâ€™s stack, the VoiceOver cursor falls on the Back button of the navigation bar. You might want to move that cursor to the heading of the navigation bar or to an element on the newly pushed page.</p> <p>å½“æ‚¨çš„åº”ç”¨åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ–°è§†å›¾æ—¶ï¼Œè¯·è€ƒè™‘è®¾ç½®å°†<code>VoiceOver</code>å…‰æ ‡çš„ä½ç½®ã€‚å½“å±å¹•å¸ƒå±€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>VoiceOver</code>ç„¦ç‚¹ç¯ï¼ˆä¹Ÿç§°ä¸º<code>VoiceOver</code>å…‰æ ‡ï¼‰ä¼šä»å·¦åˆ°å³å’Œä»ä¸Šåˆ°ä¸‹å°†å…¶ä½ç½®é‡ç½®ä¸ºå±å¹•ä¸Šæ˜¾ç¤ºçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å°†å…‰æ ‡æ”¾åœ¨æ›´åˆé€‚çš„å…ƒç´ ä¸Šå¯ä»¥åŠ å¿«ç”¨æˆ·å¯¹ç•Œé¢çš„å¯¼èˆªé€Ÿåº¦ã€‚ä¾‹å¦‚ï¼Œå½“å°†æ–°çš„è§†å›¾æ§åˆ¶å™¨æ¨é€åˆ°å¯¼èˆªæ§åˆ¶å™¨çš„å †æ ˆä¸Šæ—¶ï¼Œ<code>VoiceOver</code>å…‰æ ‡ä¼šè½åœ¨å¯¼èˆªæ çš„åé€€æŒ‰é’®ä¸Šã€‚æ‚¨å¯èƒ½å¸Œæœ›å°†å…‰æ ‡ç§»åŠ¨åˆ°å¯¼èˆªæ çš„æ ‡é¢˜æˆ–æ–°æ¨é€é¡µé¢ä¸Šçš„å…ƒç´ ä¸Šã€‚</p> <p>To change the position of the cursor, post a UIAccessibilityScreenChangedNotification notification using the UIAccessibilityPostNotification function. The notification tells VoiceOver that the contents of the screen changed. When posting the notification, specify the element to which you want to assign the focus, as shown in Listing 6-1.</p> <p>è¦æ›´æ”¹å…‰æ ‡çš„ä½ç½®ï¼Œè¯·ä½¿ç”¨<code>UIAccessibilityPostNotification</code>å‡½æ•°å‘å¸ƒ<code>UIAccessibilityScreenChangedNotification</code>é€šçŸ¥ã€‚è¯¥é€šçŸ¥å‘Šè¯‰<code>Voiceover</code>å±å¹•å†…å®¹å‘ç”Ÿäº†å˜åŒ–ã€‚å‘å¸ƒé€šçŸ¥æ—¶ï¼ŒæŒ‡å®šè¦ä¸ºå…¶åˆ†é…ç„¦ç‚¹çš„å…ƒç´ ï¼Œå¦‚æ¸…å•6-1æ‰€ç¤ºã€‚</p> <p>Listing 6-1Posting an accessibility notification can change the first element read aloud</p> <p>ç¤ºä¾‹6-1 å‘å¸ƒæ— éšœç¢é€šçŸ¥å¯ä»¥æ›´æ”¹æœ—è¯»çš„ç¬¬ä¸€ä¸ªå…ƒç´ </p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token keyword">@implementation</span> MyViewController
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidAppear<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>animated <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidAppear<span class="token punctuation">:</span>animated<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
    <span class="token comment">// The second parameter is the new focus element.</span>
    <span class="token function">UIAccessibilityPostNotification</span><span class="token punctuation">(</span>UIAccessibilityScreenChangedNotification<span class="token punctuation">,</span>
                                    <span class="token keyword">self</span><span class="token punctuation">.</span>myFirstElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">@end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Layout changes, including those caused by rotations, reset the position of the VoiceOver cursor. When the layout of your view controller changes, post the notification UIAccessibilityLayoutChangedNotification. Like the UIAccessibilityScreenChangedNotification notification, you can specify the object that you want to become the new first element for VoiceOver.</p> <p>å¸ƒå±€æ›´æ”¹ï¼ŒåŒ…æ‹¬æ—‹è½¬å¼•èµ·çš„æ›´æ”¹ï¼Œä¼šé‡ç½®Voiceoverå…‰æ ‡çš„ä½ç½®ã€‚å½“è§†å›¾æ§åˆ¶å™¨çš„å¸ƒå±€å‘ç”Ÿæ›´æ”¹æ—¶ï¼Œå‘å¸ƒé€šçŸ¥<code>UIAccessibilityLayoutChangedNotification</code>ã€‚ä¸<code>UIAccessibilityScreenChangedNotification</code>é€šçŸ¥ä¸€æ ·ï¼Œæ‚¨å¯ä»¥æŒ‡å®šè¦æˆä¸ºVoiceoverçš„æ–°ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¯¹è±¡ã€‚</p> <h3 id="å›åº”ç‰¹å®šçš„ç”»å¤–éŸ³æ‰‹åŠ¿-ğŸŸ-responding-to-special-voiceover-gestures"><a href="#å›åº”ç‰¹å®šçš„ç”»å¤–éŸ³æ‰‹åŠ¿-ğŸŸ-responding-to-special-voiceover-gestures" class="header-anchor">#</a> å›åº”ç‰¹å®šçš„ç”»å¤–éŸ³æ‰‹åŠ¿ ğŸŸ Responding to Special VoiceOver Gestures</h3> <p>VoiceOver defines five special gestures for triggering app-specific actions.</p> <ul><li><p><code>Voiceover</code>å®šä¹‰äº†äº”ç§ç‰¹æ®Šæ‰‹åŠ¿æ¥è§¦å‘ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„æ“ä½œã€‚</p></li> <li><p>Escape. A two-finger Z-shaped gesture that dismisses a modal dialog, or goes back one level in a navigation hierarchy.</p></li> <li><p><code>Escape</code>ã€‚å…³é—­æ¨¡æ€å¯¹è¯æ¡†æˆ–è¿”å›å¯¼èˆªå±‚æ¬¡ç»“æ„ä¸­çš„ä¸€ä¸ªçº§åˆ«çš„ä¸¤æŒ‡Zå½¢æ‰‹åŠ¿ã€‚</p></li> <li><p>Magic Tap. A two-finger double-tap that performs the most-intended action.</p></li> <li><p><code>Magic Tap</code>ã€‚ä¸¤æŒ‡åŒå‡»ï¼Œæ‰§è¡Œæœ€å¯èƒ½çš„åŠ¨ä½œã€‚</p></li> <li><p>Three-Finger Scroll. A three-finger swipe that scrolls content vertically or horizontally.</p></li> <li><p><code>Three-Finger Scroll</code>ã€‚å‚ç›´æˆ–æ°´å¹³æ»šåŠ¨å†…å®¹çš„ä¸‰æŒ‡æ»‘åŠ¨ã€‚</p></li> <li><p>Increment. A one-finger swipe up that increments a value in an element.</p></li> <li><p><code>Increment</code>ã€‚å•æŒ‡å‘ä¸Šæ»‘åŠ¨å¯å¢åŠ å…ƒç´ ä¸­çš„å€¼ã€‚</p></li> <li><p>Decrement. A one-finger swipe down that decrements a value in an element.</p></li> <li><p><code>Decrement</code>ã€‚å•æŒ‡å‘ä¸‹æ»‘åŠ¨ä¼šå‡å°‘å…ƒç´ ä¸­çš„å€¼ã€‚</p></li></ul> <p>Use these gestures to perform tasks that are specific to your views and view controllers. UIKit looks for a method that implements the method corresponding to the gesture. It searches for the method using the responder chain, starting with the element that has the VoiceOver focus. If no object implements the appropriate method, UIKit performs the default system action for that gesture. For example, the Magic Tap gesture plays and pauses music playback from the Music app if no Magic Tap implementation is found from the current view to the app delegate.</p> <p>ä½¿ç”¨è¿™äº›æ‰‹åŠ¿æ‰§è¡Œç‰¹å®šäºè§†å›¾å’Œè§†å›¾æ§åˆ¶å™¨çš„ä»»åŠ¡ã€‚UIKitæŸ¥æ‰¾å®ç°äº†æ‰‹åŠ¿å¯¹åº”æ–¹æ³•çš„å¯¹è±¡ã€‚å®ƒä½¿ç”¨å“åº”å™¨é“¾æœç´¢è¯¥æ–¹æ³•ï¼Œä»å…·æœ‰<code>Voiceover</code>ç„¦ç‚¹çš„å…ƒç´ å¼€å§‹ã€‚å¦‚æœæ²¡æœ‰å¯¹è±¡å®ç°é€‚å½“çš„æ–¹æ³•ï¼ŒUIKitæ‰§è¡Œè¯¥æ‰‹åŠ¿çš„é»˜è®¤ç³»ç»Ÿæ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä»å½“å‰è§†å›¾åˆ°åº”ç”¨å§”æ‰˜æ²¡æœ‰æ‰¾åˆ°<code>Magic Tap</code>å®ç°ï¼Œåˆ™<code>Magic Tap</code>æ‰‹åŠ¿ä»<code>Music</code>åº”ç”¨ç¨‹åºæ’­æ”¾å¹¶æš‚åœéŸ³ä¹æ’­æ”¾ã€‚</p> <p>Although you can take any actions you want in your handlers, VoiceOver users expect your appâ€™s actions to follow certain guidelines. Like any gesture, your implementation of a VoiceOver gesture should follow a pattern so that interaction with an accessible app remains intuitive.</p> <p>å°½ç®¡æ‚¨å¯ä»¥åœ¨å¤„ç†ç¨‹åºä¸­æ‰§è¡Œä»»ä½•æ‚¨æƒ³è¦çš„æ“ä½œï¼Œä½†<code>Voiceover</code>ç”¨æˆ·å¸Œæœ›æ‚¨çš„åº”ç”¨ç¨‹åºçš„æ“ä½œéµå¾ªæŸäº›å‡†åˆ™ã€‚ä¸ä»»ä½•æ‰‹åŠ¿ä¸€æ ·ï¼Œ<code>Voiceover</code>æ‰‹åŠ¿çš„å®ç°åº”éµå¾ªä¸€ç§æ¨¡å¼ï¼Œä»¥ä¾¿ä¸å¯è®¿é—®çš„åº”ç”¨ç¨‹åºçš„äº¤äº’ä¿æŒç›´è§‚ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>All special VoiceOver gesture methods return a Boolean value that determine whether to propagate through the responder chain. To halt propagation, return YES; otherwise, return NO.</p></div> <div class="custom-block tip"><p class="custom-block-title">æ³¨</p> <p>æ‰€æœ‰ç‰¹æ®Šçš„Voiceoveræ‰‹åŠ¿æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¯¥å€¼å†³å®šæ˜¯å¦é€šè¿‡å“åº”é“¾ä¼ æ’­ã€‚è¦åœæ­¢ä¼ æ’­ï¼Œè¿”å›YESï¼›å¦åˆ™ï¼Œè¿”å›NOã€‚</p></div> <h3 id="é€€å‡º-ğŸŸ-escape"><a href="#é€€å‡º-ğŸŸ-escape" class="header-anchor">#</a> é€€å‡º ğŸŸ Escape</h3> <p>Use the accessibilityPerformEscape method to handle the Escape gesture. For a view that overlays contentâ€”such as a modal dialog or an alertâ€”use the method to dismiss the overlay. The function of the Escape gesture is like the function of the Esc key on a computer keyboard; it cancels a temporary dialog or sheet to reveal the main content. You might also use the Escape gesture to navigate back one level in a custom navigation hierarchy. You do not need to implement this gesture if you are already using a UINavigationController object, which already handles this gesture.</p> <p>ä½¿ç”¨<code>accessibilityPerformEscape</code>æ–¹æ³•å¤„ç†<code>Escape</code>æ‰‹åŠ¿ã€‚å¯¹äºè¦†ç›–å†…å®¹çš„è§†å›¾ï¼ˆä¾‹å¦‚æ¨¡æ€å¯¹è¯æ¡†æˆ–è­¦æŠ¥ï¼‰ï¼Œä½¿ç”¨è¯¥æ–¹æ³•å…³é—­è¦†ç›–ã€‚<code>Escape</code>æ‰‹åŠ¿çš„åŠŸèƒ½ç±»ä¼¼äºè®¡ç®—æœºé”®ç›˜ä¸Šçš„Escé”®çš„åŠŸèƒ½ï¼›å®ƒå–æ¶ˆä¸´æ—¶å¯¹è¯æ¡†æˆ–å·¥ä½œè¡¨ä»¥æ˜¾ç¤ºä¸»è¦å†…å®¹ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code>Escape</code>æ‰‹åŠ¿åœ¨è‡ªå®šä¹‰å¯¼èˆªå±‚æ¬¡ç»“æ„ä¸­å‘åå¯¼èˆªä¸€å±‚ã€‚å¦‚æœæ‚¨å·²ç»åœ¨ä½¿ç”¨å·²ç»å¤„ç†æ­¤æ‰‹åŠ¿çš„<code>UINavigationController</code>å¯¹è±¡ï¼Œåˆ™ä¸éœ€è¦å®ç°æ­¤æ‰‹åŠ¿ã€‚</p> <h3 id="ä¸¤æŒ‡åŒå‡»-ğŸŸ-magic-tap"><a href="#ä¸¤æŒ‡åŒå‡»-ğŸŸ-magic-tap" class="header-anchor">#</a> ä¸¤æŒ‡åŒå‡» ğŸŸ Magic Tap</h3> <p>Use the accessibilityPerformMagicTap method to handle the Magic Tap gesture. The Magic Tap gesture performs an often-used or most-intended action quickly. For example, in the Phone app, a Magic Tap picks up or hangs up a phone call, and in the Clock app, a Magic Tap starts and stops the stopwatch. You might use this gesture to trigger actions that are not necessarily relevant to the element that the VoiceOver cursor is highlighting. To handle Magic Tap gestures from anywhere in your app, implement the accessibilityPerformMagicTap method in your app delegate.</p> <p>ä½¿ç”¨<code>accessibilityPerformMagicTap</code>æ–¹æ³•å¤„ç†<code>Magic Tap</code>æ‰‹åŠ¿ã€‚<code>Magic Tap</code>æ‰‹åŠ¿å¯å¿«é€Ÿæ‰§è¡Œå¸¸ç”¨æˆ–æœ€æœ‰æ„ä¹‰çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨ç”µè¯åº”ç”¨ä¸­ï¼Œ<code>Magic Tap</code>æ¥å¬æˆ–æŒ‚æ–­ç”µè¯ï¼Œåœ¨æ—¶é’Ÿåº”ç”¨ä¸­ï¼Œ<code>Magic Tap</code>å¯åŠ¨å’Œåœæ­¢ç§’è¡¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤æ‰‹åŠ¿è§¦å‘ä¸ä¸€å®šä¸<code>Voiceover</code>å…‰æ ‡çªå‡ºæ˜¾ç¤ºçš„å…ƒç´ ç›¸å…³çš„æ“ä½œã€‚è¦ä»åº”ç”¨ä¸­çš„ä»»ä½•ä½ç½®å¤„ç†<code>Magic Tap</code>æ‰‹åŠ¿ï¼Œè¯·åœ¨åº”ç”¨å§”æ‰˜ä¸­å®ç°<code>accessibilityPerformMagicTap</code>æ–¹æ³•ã€‚</p> <h3 id="ä¸‰æŒ‡æ»šåŠ¨-ğŸŸ-three-finger-scroll"><a href="#ä¸‰æŒ‡æ»šåŠ¨-ğŸŸ-three-finger-scroll" class="header-anchor">#</a> ä¸‰æŒ‡æ»šåŠ¨ ğŸŸ Three-Finger Scroll</h3> <p>Use the accessibilityScroll: method to scroll the content of a custom view when a VoiceOver user performs a three-finger scroll gesture. A custom view that displays the pages of a book might use this gesture to turn the page. The parameter passed to the method indicates the direction in which to scroll.</p> <p>å½“<code>Voiceover</code>ç”¨æˆ·æ‰§è¡Œä¸‰æŒ‡æ»šåŠ¨æ‰‹åŠ¿æ—¶ï¼Œä½¿ç”¨<code>accessibilityScroll:</code>æ–¹æ³•æ»šåŠ¨è‡ªå®šä¹‰è§†å›¾çš„å†…å®¹ã€‚æ˜¾ç¤ºä¹¦ç±é¡µé¢çš„è‡ªå®šä¹‰è§†å›¾å¯èƒ½ä½¿ç”¨æ­¤æ‰‹åŠ¿ç¿»é¡µã€‚ä¼ é€’ç»™è¯¥æ–¹æ³•çš„å‚æ•°æŒ‡ç¤ºæ»šåŠ¨æ–¹å‘ã€‚</p> <h3 id="å¢å¤§å’Œå‡å°-ğŸŸ-increment-and-decrement"><a href="#å¢å¤§å’Œå‡å°-ğŸŸ-increment-and-decrement" class="header-anchor">#</a> å¢å¤§å’Œå‡å° ğŸŸ Increment and Decrement</h3> <p>Use the accessibilityIncrement and accessibilityDecrement methods to increment or decrement a value in the element. Elements with the UIAccessibilityTraitAdjustable trait must implement this method.</p> <p>ä½¿ç”¨<code>accessibilityIncrement</code>å’Œ<code>accessibilityDecrement</code>æ–¹æ³•æ¥å¢åŠ æˆ–å‡å°‘å…ƒç´ ä¸­çš„å€¼ã€‚å…·æœ‰<code>UIAccessibilityTraitAdjustable</code>çš„å…ƒç´ å¿…é¡»å®ç°æ­¤æ–¹æ³•ã€‚</p> <h3 id="ç›‘å¬æ— éšœç¢é€šçŸ¥-ğŸŸ-observing-accessibility-notifications"><a href="#ç›‘å¬æ— éšœç¢é€šçŸ¥-ğŸŸ-observing-accessibility-notifications" class="header-anchor">#</a> ç›‘å¬æ— éšœç¢é€šçŸ¥ ğŸŸ Observing Accessibility Notifications</h3> <p>UIKit sends accessibility notifications to inform your app about relevant events. The objects of your app can observe any relevant notifications and use them to perform appropriate tasks. For example, the iBooks app uses the UIAccessibilityAnnouncementDidFinishNotification notification to turn the page and continue reading when VoiceOver finishes speaking the last line on a page. This behavior provides a seamless, uninterrupted reading experience.</p> <p>UIKitå‘é€æ— éšœç¢åŠŸèƒ½é€šçŸ¥ï¼Œé€šçŸ¥æ‚¨çš„åº”ç”¨æœ‰å…³ç›¸å…³äº‹ä»¶ã€‚æ‚¨çš„åº”ç”¨çš„å¯¹è±¡å¯ä»¥è§‚å¯Ÿä»»ä½•ç›¸å…³é€šçŸ¥ï¼Œå¹¶ä½¿ç”¨å®ƒä»¬æ¥æ‰§è¡Œé€‚å½“çš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼ŒiBooksåº”ç”¨ä½¿ç”¨ <code>UIAccessibilityAnnouncementDidFinishNotification</code>é€šçŸ¥ç¿»é¡µï¼Œå¹¶åœ¨<code>Voiceover</code>è¯´å®Œé¡µé¢ä¸Šçš„æœ€åä¸€è¡Œæ—¶ç»§ç»­é˜…è¯»ã€‚è¿™ç§è¡Œä¸ºæä¾›äº†æ— ç¼ã€ä¸é—´æ–­çš„é˜…è¯»ä½“éªŒã€‚</p> <p>Use the default notification center to register as an observer for accessibility notifications. Listing 6-2 shows an example of a view that records whether the reading of an announcement was successful or was interrupted by the user.</p> <p>ä½¿ç”¨é»˜è®¤é€šçŸ¥ä¸­å¿ƒæ³¨å†Œä¸ºæ— éšœç¢é€šçŸ¥çš„è§‚å¯Ÿè€…ã€‚æ¸…å•6-2æ˜¾ç¤ºäº†ä¸€ä¸ªè§†å›¾ç¤ºä¾‹ï¼Œè¯¥è§†å›¾è®°å½•äº†å¯¹å…¬å‘Šçš„é˜…è¯»æ˜¯æˆåŠŸçš„è¿˜æ˜¯è¢«ç”¨æˆ·ä¸­æ–­çš„ã€‚</p> <p>Listing 6-2Registering as an observer for accessibility notifications</p> <p>ç¤ºä¾‹6-2æ³¨å†Œä¸ºå¯è®¿é—®æ€§é€šçŸ¥çš„è§‚å¯Ÿè€…</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token keyword">@implementation</span> MyViewController
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidLoad
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidLoad<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
    <span class="token punctuation">[</span><span class="token punctuation">[</span>NSNotificationCenter defaultCenter<span class="token punctuation">]</span>
        addObserver<span class="token punctuation">:</span><span class="token keyword">self</span>
           selector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>didFinishAnnouncement<span class="token punctuation">:</span><span class="token punctuation">)</span>
               name<span class="token punctuation">:</span>UIAccessibilityAnnouncementDidFinishNotification
             object<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
 
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>didFinishAnnouncement<span class="token punctuation">:</span><span class="token punctuation">(</span>NSNotification <span class="token operator">*</span><span class="token punctuation">)</span>dict
<span class="token punctuation">{</span>
    NSString <span class="token operator">*</span>valueSpoken <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>dict userInfo<span class="token punctuation">]</span> objectForKey<span class="token punctuation">:</span>UIAccessibilityAnnouncementKeyStringValue<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>wasSuccessful <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>dict userInfo<span class="token punctuation">]</span> objectForKey<span class="token punctuation">:</span>UIAccessibilityAnnouncementKeyWasSuccessful<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token keyword">@end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>Another helpful notification to subscribe to is the UIAccessibilityVoiceOverStatusChanged notification. You can use that notification to detect when VoiceOver is toggled on or off. If this notification occurs while your app is suspended, you receive the notification when your app returns to the foreground.</p> <p>å¦ä¸€ä¸ªéœ€è¦è®¢é˜…çš„æœ‰ç”¨é€šçŸ¥æ˜¯<code>UIAccessibilityVoiceOverStatusChanged</code>é€šçŸ¥ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¯¥é€šçŸ¥æ¥æ£€æµ‹<code>Voiceover</code>ä½•æ—¶æ‰“å¼€æˆ–å…³é—­ã€‚å¦‚æœåœ¨åº”ç”¨æš‚åœæ—¶å‡ºç°æ­¤é€šçŸ¥ï¼Œåˆ™åœ¨åº”ç”¨è¿”å›å‰å°æ—¶æ”¶åˆ°é€šçŸ¥ã€‚</p> <p>For a list of accessibility notifications you can observe, see UIAccessibility Protocol Reference.</p> <p>æœ‰å…³æ‚¨å¯ä»¥è§‚å¯Ÿåˆ°çš„æ— éšœç¢åŠŸèƒ½é€šçŸ¥åˆ—è¡¨ï¼Œè¯·å‚é˜…<code>UIAccess</code>åè®®å‚è€ƒ<a href="https://developer.apple.com/documentation/objectivec/nsobject/uiaccessibility" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h2 id="_4-ä¿å­˜å’Œæ¢å¤çŠ¶æ€-ğŸŸ-preserving-and-restoring-state"><a href="#_4-ä¿å­˜å’Œæ¢å¤çŠ¶æ€-ğŸŸ-preserving-and-restoring-state" class="header-anchor">#</a> 4. ä¿å­˜å’Œæ¢å¤çŠ¶æ€ ğŸŸ Preserving and Restoring State</h2> <p>View controllers play an important role in the state preservation and restoration process. State preservation records the configuration of your app before it is suspended so that the configuration can be restored on a subsequent app launch. Returning an app to its previous configuration saves time for the user and offers a better user experience.</p> <p>è§†å›¾æ§åˆ¶å™¨åœ¨çŠ¶æ€ä¿å­˜å’Œæ¢å¤è¿‡ç¨‹ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚çŠ¶æ€ä¿å­˜ä¼šåœ¨åº”ç”¨æš‚åœä¹‹å‰è®°å½•å…¶é…ç½®ï¼Œä»¥ä¾¿åœ¨åç»­åº”ç”¨å¯åŠ¨æ—¶æ¢å¤é…ç½®ã€‚å°†åº”ç”¨æ¢å¤åˆ°ä»¥å‰çš„é…ç½®å¯ä»¥ä¸ºç”¨æˆ·èŠ‚çœæ—¶é—´å¹¶æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p> <p>The preservation and restoration process is mostly automatic, but you need to tell iOS which parts of your app to preserve. The steps for preserving your appâ€™s view controllers are as follows:</p> <p>ä¿å­˜å’Œæ¢å¤çš„å¤„ç†å¤§å¤šæ˜¯è‡ªåŠ¨çš„ï¼Œä½†æ‚¨éœ€è¦å‘Šè¯‰iOSè¦ä¿ç•™åº”ç”¨çš„å“ªäº›éƒ¨åˆ†ã€‚ä¿ç•™åº”ç”¨è§†å›¾æ§åˆ¶å™¨çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ul><li><p>(Required) Assign restoration identifiers to the view controllers whose configuration you want to preserve; see Tagging View Controllers for Preservation.</p></li> <li><p>ï¼ˆå¿…éœ€ï¼‰å°†æ¢å¤æ ‡è¯†ç¬¦åˆ†é…ç»™è¦ä¿ç•™å…¶é…ç½®çš„è§†å›¾æ§åˆ¶å™¨ï¼›è¯·å‚é˜…<em>æ ‡è®°è§†å›¾æ§åˆ¶å™¨</em><a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/PreservingandRestoringState.html#//apple_ref/doc/uid/TP40007457-CH28-SW2" target="_blank" rel="noopener noreferrer">ï½œåŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä»¥è¿›è¡Œä¿ç•™ã€‚</p></li> <li><p>(Required) Tell iOS how to create or locate new view controller objects at launch time; see Restoring View Controllers at Launch Time.</p></li> <li><p>ï¼ˆå¿…éœ€ï¼‰å‘Šè¯‰iOSå¦‚ä½•åœ¨å¯åŠ¨æ—¶åˆ›å»ºæˆ–å®šä½æ–°çš„è§†å›¾æ§åˆ¶å™¨å¯¹è±¡ï¼›è¯·å‚é˜…åœ¨<em>å¯åŠ¨æ—¶æ¢å¤è§†å›¾æ§åˆ¶å™¨</em><a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/PreservingandRestoringState.html#//apple_ref/doc/uid/TP40007457-CH28-SW5" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></li> <li><p>(Optional) For each view controller, store any specific configuration data needed to return that view controller to its original configuration; see Encoding and Decoding Your View Controllerâ€™s State.</p></li> <li><p>ï¼ˆå¯é€‰ï¼‰å¯¹äºæ¯ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼Œå­˜å‚¨æ¢å¤åˆ°å…¶åŸå§‹é…ç½®æ‰€éœ€çš„ä»»ä½•ç‰¹å®šé…ç½®æ•°æ®ï¼›è¯·å‚é˜…<em>ç¼–ç å’Œè§£ç æ‚¨çš„è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€</em><a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/PreservingandRestoringState.html#//apple_ref/doc/uid/TP40007457-CH28-SW6" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></li></ul> <p>For an overview of the preservation and restoration process, see App Programming Guide for iOS.</p> <p>æœ‰å…³ä¿å­˜å’Œæ¢å¤è¿‡ç¨‹çš„æ¦‚è¿°ï¼Œè¯·å‚é˜…iOSçš„åº”ç”¨ç¨‹åºç¼–ç¨‹æŒ‡å—<a href="https://developer.apple.com/documentation/uikit#//apple_ref/doc/uid/TP40007072" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="æ ‡è®°ä¿å­˜è§†å›¾æ§åˆ¶å™¨-ğŸŸ-tagging-view-controllers-for-preservation"><a href="#æ ‡è®°ä¿å­˜è§†å›¾æ§åˆ¶å™¨-ğŸŸ-tagging-view-controllers-for-preservation" class="header-anchor">#</a> æ ‡è®°ä¿å­˜è§†å›¾æ§åˆ¶å™¨ ğŸŸ Tagging View Controllers for Preservation</h3> <p>UIKit preserves only the view controllers you tell it to preserve. Each view controller has a restorationIdentifier property, whose value is nil by default. Setting that property to a valid string tells UIKit that the view controller and its views should be preserved. You can assign restoration identifiers programmatically or in your storyboard file.</p> <p>UIKitåªä¿ç•™æ‚¨å‘Šè¯‰å®ƒè¦ä¿ç•™çš„è§†å›¾æ§åˆ¶å™¨ã€‚æ¯ä¸ªè§†å›¾æ§åˆ¶å™¨éƒ½æœ‰ä¸€ä¸ª<code>restorationIdentifier</code>å±æ€§ï¼Œé»˜è®¤å€¼ä¸º<code>nil</code>ã€‚å°†è¯¥å±æ€§è®¾ç½®ä¸ºæœ‰æ•ˆå­—ç¬¦ä¸²å‘Šè¯‰UIKitåº”è¯¥ä¿ç•™è§†å›¾æ§åˆ¶å™¨åŠå…¶è§†å›¾ã€‚æ‚¨å¯ä»¥ä»¥ç¼–ç¨‹æ–¹å¼æˆ–åœ¨æ•…äº‹æ¿æ–‡ä»¶ä¸­åˆ†é…<code>restorationIdentifier</code>ã€‚</p> <p>When assigning restoration identifiers, remember that all parent view controllers in the view controller hierarchy must have restoration identifiers too. During the preservation process, UIKit starts at the windowâ€™s root view controller and walks the view controller hierarchy. If a view controller in that hierarchy does not have a restoration identifier, the view controller and all of its child view controllers and presented view controllers are ignored.</p> <p>åˆ†é…<code>restorationIdentifier</code>æ—¶ï¼Œè¯·è®°ä½è§†å›¾æ§åˆ¶å™¨å±‚æ¬¡ç»“æ„ä¸­çš„æ‰€æœ‰çˆ¶è§†å›¾æ§åˆ¶å™¨ä¹Ÿå¿…é¡»å…·æœ‰<code>restorationIdentifier</code>ã€‚åœ¨ä¿å­˜è¿‡ç¨‹ä¸­ï¼ŒUIKitä»çª—å£çš„æ ¹è§†å›¾æ§åˆ¶å™¨å¼€å§‹å¹¶éå†è§†å›¾æ§åˆ¶å™¨å±‚æ¬¡ç»“æ„ã€‚å¦‚æœè¯¥å±‚æ¬¡ç»“æ„ä¸­çš„è§†å›¾æ§åˆ¶å™¨æ²¡æœ‰<code>restorationIdentifier</code>ï¼Œåˆ™è§†å›¾æ§åˆ¶å™¨åŠå…¶æ‰€æœ‰å­è§†å›¾æ§åˆ¶å™¨å’Œè¢«å‘ˆç°çš„è§†å›¾æ§åˆ¶å™¨å°†è¢«å¿½ç•¥ã€‚</p> <h3 id="é€‰æ‹©æœ‰æ•ˆçš„restorationidentifier-ğŸŸ-choosing-effective-restoration-identifiers"><a href="#é€‰æ‹©æœ‰æ•ˆçš„restorationidentifier-ğŸŸ-choosing-effective-restoration-identifiers" class="header-anchor">#</a> é€‰æ‹©æœ‰æ•ˆçš„<code>restorationIdentifier</code> ğŸŸ Choosing Effective Restoration Identifiers</h3> <p>UIKit uses your restoration identifier strings to recreate view controllers later, so choose strings that are easily identifiable to your code. If UIKit cannot automatically create one of your view controllers, it asks you to create it, providing you with the restoration identifiers of the view controller and all of its parent view controllers. This chain of identifiers represents the restoration path for the view controller and is how you determine which view controller is being requested. The restoration path starts at the root view controller and includes every view controller up to and including the one that was requested.</p> <p>UIKitä½¿ç”¨æ‚¨çš„<code>restorationIdentifier</code>å­—ç¬¦ä¸²ç¨åé‡æ–°åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ï¼Œå› æ­¤é€‰æ‹©æ˜“äºè¯†åˆ«æ‚¨çš„ä»£ç çš„å­—ç¬¦ä¸²ã€‚å¦‚æœUIKitæ— æ³•è‡ªåŠ¨åˆ›å»ºæ‚¨çš„è§†å›¾æ§åˆ¶å™¨ä¹‹ä¸€ï¼Œå®ƒä¼šè¦æ±‚æ‚¨åˆ›å»ºå®ƒï¼Œä¸ºæ‚¨æä¾›è§†å›¾æ§åˆ¶å™¨åŠå…¶æ‰€æœ‰çˆ¶è§†å›¾æ§åˆ¶å™¨çš„<code>restorationIdentifier</code>ã€‚è¿™ä¸ªæ ‡è¯†ç¬¦é“¾ä»£è¡¨è§†å›¾æ§åˆ¶å™¨çš„æ¢å¤è·¯å¾„ï¼Œä¹Ÿæ˜¯æ‚¨ç¡®å®šæŒ‡å®šå“ªä¸ªè§†å›¾æ§åˆ¶å™¨çš„æ–¹å¼ã€‚æ¢å¤è·¯å¾„ä»æ ¹è§†å›¾æ§åˆ¶å™¨å¼€å§‹ï¼ŒåŒ…æ‹¬æ¯ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼Œä¸€ç›´åˆ°åŒ…æ‹¬è¢«æŒ‡å®šçš„è§†å›¾æ§åˆ¶å™¨ã€‚</p> <p>Restoration identifiers are often just the class name of the view controller. If you use the same class in many places, you might want to assign more meaningful values. For example, you might assign a string based on the data being managed by the view controller.</p> <p><code>restorationIdentifier</code>é€šå¸¸åªæ˜¯è§†å›¾æ§åˆ¶å™¨çš„ç±»åã€‚å¦‚æœæ‚¨åœ¨è®¸å¤šåœ°æ–¹ä½¿ç”¨ç›¸åŒçš„ç±»ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åˆ†é…æ›´æœ‰æ„ä¹‰çš„å€¼ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥æ ¹æ®è§†å›¾æ§åˆ¶å™¨ç®¡ç†çš„æ•°æ®åˆ†é…ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p> <p>The restoration path for every view controller must be unique. If a container view controller has two children, the container must assign each child a unique restoration identifier. Some container view controllers in UIKit automatically disambiguate their child view controllers, allowing you to use the same restoration identifiers for each child. For example, the UINavigationController class adds information to each child based on its position in the navigation stack. For more information about the behavior of a given view controller, see the corresponding class reference.</p> <p>æ¯ä¸ªè§†å›¾æ§åˆ¶å™¨çš„æ¢å¤è·¯å¾„å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å¦‚æœå®¹å™¨è§†å›¾æ§åˆ¶å™¨æœ‰ä¸¤ä¸ªå­VCï¼Œåˆ™å®¹å™¨å¿…é¡»ä¸ºæ¯ä¸ªå­è§†å›¾æ§åˆ¶å™¨åˆ†é…å”¯ä¸€çš„æ¢å¤æ ‡è¯†ç¬¦ã€‚UIKitä¸­çš„ä¸€äº›å®¹å™¨è§†å›¾æ§åˆ¶å™¨ä¼šè‡ªåŠ¨æ¶ˆé™¤å…¶å­è§†å›¾æ§åˆ¶å™¨çš„æ­§ä¹‰ï¼Œå…è®¸æ‚¨ä¸ºæ¯ä¸ªå­è§†å›¾æ§åˆ¶å™¨ä½¿ç”¨ç›¸åŒçš„æ¢å¤æ ‡è¯†ç¬¦ã€‚ä¾‹å¦‚ï¼Œ<code>UINavigationController</code>ç±»æ ¹æ®æ¯ä¸ªå­è§†å›¾åœ¨å¯¼èˆªå †æ ˆä¸­çš„ä½ç½®å‘å…¶æ·»åŠ ä¿¡æ¯ã€‚æœ‰å…³ç»™å®šè§†å›¾æ§åˆ¶å™¨è¡Œä¸ºçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ç›¸åº”çš„ç±»å¼•ç”¨ã€‚</p> <p>For more information on how you use restoration identifiers and restoration paths to create view controllers, see Restoring View Controllers at Launch Time.</p> <p>æœ‰å…³å¦‚ä½•ä½¿ç”¨<code>restoration identifiers</code>å’Œ<code>restoration paths</code>åˆ›å»ºè§†å›¾æ§åˆ¶å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…åœ¨<em>å¯åŠ¨æ—¶è¿˜åŸè§†å›¾æ§åˆ¶å™¨</em><a href="https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/PreservingandRestoringState.html#//apple_ref/doc/uid/TP40007457-CH28-SW5" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="æ’é™¤è§†å›¾æ§åˆ¶å™¨ç»„-ğŸŸ-excluding-groups-of-view-controllers"><a href="#æ’é™¤è§†å›¾æ§åˆ¶å™¨ç»„-ğŸŸ-excluding-groups-of-view-controllers" class="header-anchor">#</a> æ’é™¤è§†å›¾æ§åˆ¶å™¨ç»„ ğŸŸ Excluding Groups of View Controllers</h3> <p>To exclude an entire group of view controllers from the restoration process, set the restoration identifier of the parent view controller to nil. Figure 7-1 shows the impact that setting the restoration identifier to nil has on the view controller hierarchy. The lack of preservation data prevents that view controller from being restored later.</p> <p>è¦ä»æ¢å¤è¿‡ç¨‹ä¸­æ’é™¤æ•´ç»„è§†å›¾æ§åˆ¶å™¨ï¼Œè¯·å°†çˆ¶è§†å›¾æ§åˆ¶å™¨çš„æ¢å¤æ ‡è¯†ç¬¦è®¾ç½®ä¸º<code>nil</code>ã€‚å›¾7-1æ˜¾ç¤ºäº†å°†æ¢å¤æ ‡è¯†ç¬¦è®¾ç½®ä¸º<code>nil</code>å¯¹è§†å›¾æ§åˆ¶å™¨å±‚æ¬¡ç»“æ„çš„å½±å“ã€‚ç¼ºå°‘ä¿å­˜ä¸‹çš„ä¾æ®ä¼šé˜»æ­¢ä»¥åæ¢å¤è¯¥è§†å›¾æ§åˆ¶å™¨ã€‚</p> <p>Figure 7-1Excluding view controllers from the automatic preservation process</p> <p>å›¾7-1 ä»è‡ªåŠ¨ä¿å­˜è¿‡ç¨‹ä¸­æ’é™¤è§†å›¾æ§åˆ¶å™¨</p> <p><img src="/static_page/assets/img/state_vc_caveats_2x.7f64f3b7.png" alt=""></p> <p>Excluding one or more view controllers does not remove them altogether during a subsequent restore. At launch time, any view controllers that are part of your appâ€™s default setup are still created, as shown in Figure 7-2. Such view controllers are recreated in their default configuration, but they are still created.</p> <p>æ’é™¤ä¸€ä¸ªæˆ–å¤šä¸ªè§†å›¾æ§åˆ¶å™¨ä¸ä¼šåœ¨åç»­è¿˜åŸæœŸé—´å®Œå…¨åˆ é™¤å®ƒä»¬ã€‚åœ¨å¯åŠ¨æ—¶ï¼Œä»ä¼šåˆ›å»ºå±äºåº”ç”¨é»˜è®¤è®¾ç½®çš„ä»»ä½•è§†å›¾æ§åˆ¶å™¨ï¼Œå¦‚å›¾7-2æ‰€ç¤ºã€‚æ­¤ç±»è§†å›¾æ§åˆ¶å™¨ä¼šåœ¨å…¶é»˜è®¤é…ç½®ä¸­é‡æ–°åˆ›å»ºï¼Œä½†ä»ä¼šåˆ›å»ºã€‚</p> <p>Figure 7-2Loading the default set of view controllers</p> <p>å›¾7-2 åŠ è½½é»˜è®¤çš„è§†å›¾æ§åˆ¶å™¨é›†</p> <p><img src="/static_page/assets/img/state_vc_caveats_2_2x.0238313d.png" alt=""></p> <p>Excluding a view controller from the automatic preservation process does not prevent you from preserving it manually. Saving a reference to the view controller in the restoration archive preserves the view controller and its state information. For example, if the app delegate in Figure 7-1 saved the three children of the navigation controller, their state would be preserved. During a restore, the app delegate could then recreate those view controllers and push them onto the navigation controllerâ€™s stack.</p> <p>ä»è‡ªåŠ¨ä¿å­˜è¿‡ç¨‹ä¸­æ’é™¤è§†å›¾æ§åˆ¶å™¨ä¸ä¼šé˜»æ­¢æ‚¨æ‰‹åŠ¨ä¿å­˜å®ƒã€‚åœ¨æ¢å¤å­˜æ¡£ä¸­ä¿å­˜å¯¹è§†å›¾æ§åˆ¶å™¨çš„å¼•ç”¨ä¼šä¿ç•™è§†å›¾æ§åˆ¶å™¨åŠå…¶çŠ¶æ€ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå›¾7-1ä¸­çš„åº”ç”¨ç¨‹åºå§”æ‰˜ä¿å­˜äº†å¯¼èˆªæ§åˆ¶å™¨çš„ä¸‰ä¸ªå­çº§ï¼Œå®ƒä»¬çš„çŠ¶æ€å°†è¢«ä¿ç•™ã€‚åœ¨æ¢å¤æœŸé—´ï¼Œåº”ç”¨ç¨‹åºå§”æ‰˜å¯ä»¥é‡æ–°åˆ›å»ºè¿™äº›è§†å›¾æ§åˆ¶å™¨å¹¶å°†å®ƒä»¬æ¨é€åˆ°å¯¼èˆªæ§åˆ¶å™¨çš„å †æ ˆä¸Šã€‚</p> <h3 id="ä¿ç•™è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾-ğŸŸ-preserving-a-view-controller-s-views"><a href="#ä¿ç•™è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾-ğŸŸ-preserving-a-view-controller-s-views" class="header-anchor">#</a> ä¿ç•™è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾ ğŸŸ Preserving a View Controllerâ€™s Views</h3> <p>Some views have additional state information that is relevant to the view but not to the parent view controller. For example, a scroll view has a scroll position that you might want to preserve. While the view controller is responsible for providing the content of the scroll view, the scroll view itself is responsible for preserving its visual state.</p> <p>ä¸€äº›è§†å›¾å…·æœ‰ä¸è§†å›¾ç›¸å…³ä½†ä¸çˆ¶è§†å›¾æ§åˆ¶å™¨æ— å…³çš„é™„åŠ çŠ¶æ€ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œæ»šåŠ¨è§†å›¾å…·æœ‰æ‚¨å¯èƒ½æƒ³è¦ä¿ç•™çš„æ»šåŠ¨ä½ç½®ã€‚è™½ç„¶è§†å›¾æ§åˆ¶å™¨è´Ÿè´£æä¾›æ»šåŠ¨è§†å›¾çš„å†…å®¹ï¼Œä½†æ»šåŠ¨è§†å›¾æœ¬èº«è´Ÿè´£ä¿ç•™å…¶è§†è§‰çŠ¶æ€ã€‚</p> <p>To save a viewâ€™s state, do the following:</p> <p>è¦ä¿å­˜è§†å›¾çš„çŠ¶æ€ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p> <ul><li><p>Assign a valid string to the viewâ€™s restorationIdentifier property.</p></li> <li><p>å°†æœ‰æ•ˆå­—ç¬¦ä¸²åˆ†é…ç»™è§†å›¾çš„restorationIdentifierå±æ€§ã€‚</p></li> <li><p>Use the view from a view controller that also has a valid restoration identifier.</p></li> <li><p>ä½¿ç”¨å…·æœ‰æœ‰æ•ˆ<code>restoration identifier</code>çš„è§†å›¾æ§åˆ¶å™¨ä¸­çš„è§†å›¾ã€‚</p></li> <li><p>For table views and collection views, assign a data source that adopts the UIDataSourceModelAssociation protocol.</p></li> <li><p>å¯¹äºè¡¨è§†å›¾å’Œé›†åˆè§†å›¾ï¼Œåˆ†é…é‡‡ç”¨<code>UIDataSourceModelAssociation</code>åè®®çš„æ•°æ®æºã€‚</p></li></ul> <p>Assigning a restoration identifier to a view tells UIKit that it should write that viewâ€™s state to the preservation archive. When the view controller is restored later, UIKit also restores the state of any views that had restoration identifiers.</p> <p>å°†æ¢å¤æ ‡è¯†ç¬¦åˆ†é…ç»™è§†å›¾å‘Šè¯‰UIKitå®ƒåº”è¯¥å°†è¯¥è§†å›¾çš„çŠ¶æ€å†™å…¥ä¿å­˜å­˜æ¡£ã€‚å½“è§†å›¾æ§åˆ¶å™¨ç¨åæ¢å¤æ—¶ï¼ŒUIKitè¿˜ä¼šæ¢å¤ä»»ä½•å…·æœ‰æ¢å¤æ ‡è¯†ç¬¦çš„è§†å›¾çš„çŠ¶æ€ã€‚</p> <h3 id="åœ¨å¯åŠ¨æ—¶æ¢å¤è§†å›¾æ§åˆ¶å™¨-ğŸŸ-restoring-view-controllers-at-launch-time"><a href="#åœ¨å¯åŠ¨æ—¶æ¢å¤è§†å›¾æ§åˆ¶å™¨-ğŸŸ-restoring-view-controllers-at-launch-time" class="header-anchor">#</a> åœ¨å¯åŠ¨æ—¶æ¢å¤è§†å›¾æ§åˆ¶å™¨ ğŸŸ Restoring View Controllers at Launch Time</h3> <p>At launch time, UIKit tries to restore your app to its previous state. At that time, UIKit asks your app to create (or locate) the view controller objects that comprise your preserved user interface. UIKit searches in the following order when trying to locate view controllers:</p> <p>åœ¨å¯åŠ¨æ—¶ï¼ŒUIKitä¼šå°è¯•å°†æ‚¨çš„åº”ç”¨æ¢å¤åˆ°ä»¥å‰çš„çŠ¶æ€ã€‚æ­¤æ—¶ï¼ŒUIKitä¼šè¦æ±‚æ‚¨çš„åº”ç”¨åˆ›å»ºï¼ˆæˆ–å®šä½ï¼‰æ„æˆæ‚¨ä¿ç•™çš„ç”¨æˆ·äº¤äº’ç•Œé¢çš„è§†å›¾æ§åˆ¶å™¨å¯¹è±¡ã€‚UIKitåœ¨å°è¯•å®šä½è§†å›¾æ§åˆ¶å™¨æ—¶æŒ‰ä»¥ä¸‹é¡ºåºè¿›è¡Œæœç´¢ï¼š</p> <ul><li><p>If the view controller had a restoration class, UIKit asks that class to provide the view controller. UIKit calls the         viewControllerWithRestorationIdentifierPath:coder: method of the associated restoration class to retrieve the view controller. If that method returns nil, it is assumed that the app does not want to recreate the view controller and UIKit stops looking for it.</p></li> <li><p><strong>å¦‚æœè§†å›¾æ§åˆ¶å™¨æœ‰<code>restoration class</code>ï¼ŒUIKitä¼šè¦æ±‚è¯¥ç±»æä¾›è§†å›¾æ§åˆ¶å™¨ã€‚</strong> UIKitè°ƒç”¨<code>viewControllerWithRestorationIdentifierPath:coder:</code>æ–¹æ³•æ¥æ£€ç´¢è§†å›¾æ§åˆ¶å™¨ã€‚å¦‚æœè¯¥æ–¹æ³•è¿”å›<code>nil</code>ï¼Œåˆ™å‡å®šåº”ç”¨ç¨‹åºä¸æƒ³é‡æ–°åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ï¼ŒUIKitåœæ­¢å¯»æ‰¾å®ƒã€‚</p></li> <li><p>If the view controller did not have a restoration class, UIKit asks the app delegate to provide the view controller. UIKit calls the application:viewControllerWithRestorationIdentifierPath:coder: method of your app delegate to look for view controllers without a restoration class. If that method returns nil, UIKit tries to find the view controller implicitly.</p></li> <li><p><strong>å¦‚æœè§†å›¾æ§åˆ¶å™¨æ²¡æœ‰<code>restoration class</code>ï¼ŒUIKitä¼šè¦æ±‚åº”ç”¨å§”æ‰˜æä¾›è§†å›¾æ§åˆ¶å™¨ã€‚</strong> UIKitä¼šè°ƒç”¨åº”ç”¨å§”æ‰˜çš„<code>application:viewControllerWithRestorationIdentifierPath:coder:</code>æ–¹æ³•æ¥æŸ¥æ‰¾æ²¡æœ‰<code>restoration class</code>çš„è§†å›¾æ§åˆ¶å™¨ã€‚å¦‚æœè¯¥æ–¹æ³•è¿”å›<code>nil</code>ï¼ŒUIKitä¼šå°è¯•éšå¼æŸ¥æ‰¾è§†å›¾æ§åˆ¶å™¨ã€‚</p></li> <li><p>If a view controller with the correct restoration path already exists, UIKit uses that object. If your app creates view controllers at launch time (either programmatically or by loading them from a storyboard) and those view controllers have restoration identifiers, UIKit finds them implicitly based on their restoration paths.</p></li> <li><p><strong>å¦‚æœå…·æœ‰æ­£ç¡®<code>restoration path</code>çš„è§†å›¾æ§åˆ¶å™¨å·²ç»å­˜åœ¨ï¼ŒUIKitå°†ä½¿ç”¨è¯¥å¯¹è±¡ã€‚</strong> å¦‚æœæ‚¨çš„åº”ç”¨åœ¨å¯åŠ¨æ—¶åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ï¼ˆä»¥ç¼–ç¨‹æ–¹å¼æˆ–é€šè¿‡ä»æ•…äº‹æ¿åŠ è½½å®ƒä»¬ï¼‰å¹¶ä¸”è¿™äº›è§†å›¾æ§åˆ¶å™¨å…·æœ‰æ¢å¤æ ‡è¯†ç¬¦ï¼ŒUIKitä¼šæ ¹æ®å®ƒä»¬çš„<code>restoration path</code>éšå¼æŸ¥æ‰¾å®ƒä»¬ã€‚</p></li> <li><p>If the view controller was originally loaded from a storyboard file, UIKit uses the saved storyboard information to locate and create it. UIKit saves information about a view controllerâ€™s storyboard inside the restoration archive. At restore time, UIKit uses that information to locate the same storyboard file and instantiate the corresponding view controller if the view controller was not found by any other means.</p></li> <li><p><strong>å¦‚æœè§†å›¾æ§åˆ¶å™¨æœ€åˆæ˜¯ä»æ•…äº‹æ¿æ–‡ä»¶åŠ è½½çš„ï¼ŒUIKitä½¿ç”¨ä¿å­˜çš„æ•…äº‹æ¿ä¿¡æ¯æ¥å®šä½å’Œåˆ›å»ºå®ƒã€‚</strong> UIKitå°†è§†å›¾æ§åˆ¶å™¨çš„æ•…äº‹æ¿ä¿¡æ¯ä¿å­˜åœ¨æ¢å¤å­˜æ¡£ä¸­ã€‚åœ¨æ¢å¤æ—¶ï¼ŒUIKitä½¿ç”¨è¯¥ä¿¡æ¯æ¥å®šä½ç›¸åŒçš„æ•…äº‹æ¿æ–‡ä»¶ï¼Œå¹¶åœ¨é€šè¿‡ä»»ä½•å…¶ä»–æ–¹å¼æœªæ‰¾åˆ°è§†å›¾æ§åˆ¶å™¨æ—¶å®ä¾‹åŒ–ç›¸åº”çš„è§†å›¾æ§åˆ¶å™¨ã€‚</p></li></ul> <p>Assigning a restoration class to a view controller prevents UIKit from searching for that view controller implicitly. Using a restoration class gives you more control over whether you really want to create a view controller. For example, your viewControllerWithRestorationIdentifierPath:coder: method can return nil if your class determines that the view controller should not be recreated. When no restoration class is present, UIKit does everything it can to find or create the view controller and restore it.</p> <p>å°†<code>restoration class</code>åˆ†é…ç»™è§†å›¾æ§åˆ¶å™¨å¯ä»¥é˜²æ­¢UIKitéšå¼æœç´¢è¯¥è§†å›¾æ§åˆ¶å™¨ã€‚ä½¿ç”¨<code>restoration class</code>å¯ä»¥è®©æ‚¨æ›´å¥½åœ°æ§åˆ¶æ˜¯å¦çœŸçš„è¦åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ç±»ç¡®å®šä¸åº”é‡æ–°åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ï¼Œæ‚¨çš„<code>viewControllerWithRestorationIdentifierPath:coder:</code>æ–¹æ³•å¯ä»¥è¿”å›<code>nil</code>ã€‚å½“ä¸å­˜åœ¨<code>restoration class</code>æ—¶ï¼ŒUIKitä¼šå°½å…¶æ‰€èƒ½æŸ¥æ‰¾æˆ–åˆ›å»ºè§†å›¾æ§åˆ¶å™¨å¹¶å°†å…¶æ¢å¤ã€‚</p> <p>When using a restoration class, your viewControllerWithRestorationIdentifierPath:coder: method should create a new instance of the class, perform minimal initialization, and return the resulting object. Listing 7-1 shows an example of how you might use this method to load a view controller from a storyboard. Because the view controller was originally loaded from a storyboard, this method uses the UIStateRestorationViewControllerStoryboardKey key to get the storyboard from the archive. Note that this method does not try to configure the view controllerâ€™s data fields. That step occurs later when the view controllerâ€™s state is decoded.</p> <p>ä½¿ç”¨<code>restoration class</code>æ—¶ï¼Œæ‚¨çš„<code>viewControllerWithRestorationIdentifierPath:coder:</code>æ–¹æ³•åº”è¯¥åˆ›å»ºè¯¥ç±»çš„æ–°å®ä¾‹ï¼Œæ‰§è¡Œæœ€å°åˆå§‹åŒ–ï¼Œå¹¶è¿”å›ç»“æœå¯¹è±¡ã€‚æ¸…å•7-1æ˜¾ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨æ­¤æ–¹æ³•ä»æ•…äº‹æ¿åŠ è½½è§†å›¾æ§åˆ¶å™¨ã€‚å› ä¸ºè§†å›¾æ§åˆ¶å™¨æœ€åˆæ˜¯ä»æ•…äº‹æ¿åŠ è½½çš„ï¼Œå› æ­¤æ­¤æ–¹æ³•ä½¿ç”¨<code>UIStateRestorationViewControllerStoryboardKey</code>é”®ä»å­˜æ¡£ä¸­è·å–æ•…äº‹æ¿ã€‚è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ³•ä¸ä¼šå°è¯•é…ç½®è§†å›¾æ§åˆ¶å™¨çš„æ•°æ®å­—æ®µã€‚è¯¥æ­¥éª¤ç¨ååœ¨è§£ç è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€æ—¶å‘ç”Ÿã€‚</p> <p>Listing 7-1Creating a new view controller during restoration</p> <p>ç¤ºä¾‹7-1åœ¨æ¢å¤æœŸé—´åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾æ§åˆ¶å™¨</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">+</span> <span class="token punctuation">(</span>UIViewController <span class="token operator">*</span><span class="token punctuation">)</span>viewControllerWithRestorationIdentifierPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSArray <span class="token operator">*</span><span class="token punctuation">)</span>identifierComponents
                      coder<span class="token punctuation">:</span><span class="token punctuation">(</span>NSCoder <span class="token operator">*</span><span class="token punctuation">)</span>coder
<span class="token punctuation">{</span>
   MyViewController <span class="token operator">*</span>vc<span class="token punctuation">;</span>
   UIStoryboard <span class="token operator">*</span>sb <span class="token operator">=</span> <span class="token punctuation">[</span>coder decodeObjectForKey<span class="token punctuation">:</span>UIStateRestorationViewControllerStoryboardKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>sb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      vc <span class="token operator">=</span> <span class="token punctuation">(</span>PushViewController <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">[</span>sb instantiateViewControllerWithIdentifier<span class="token punctuation">:</span><span class="token string">@&quot;MyViewController&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      vc<span class="token punctuation">.</span>restorationIdentifier <span class="token operator">=</span> <span class="token punctuation">[</span>identifierComponents lastObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
      vc<span class="token punctuation">.</span>restorationClass <span class="token operator">=</span> <span class="token punctuation">[</span>MyViewController class<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
    <span class="token keyword">return</span> vc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Reassigning the restoration identifier and restoration class is a good habit to adopt when recreating view controllers manually. The simplest way to restore the restoration identifier is to grab the last item in the identifierComponents array and assign it to your view controller.</p> <p>é‡æ–°åˆ†é…<code>restoration identifier</code>å’Œ<code>restoration class</code>æ˜¯æ‰‹åŠ¨é‡æ–°åˆ›å»ºè§†å›¾æ§åˆ¶å™¨æ—¶é‡‡ç”¨çš„ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚æ¢å¤<code>restoration identifier</code>çš„æœ€ç®€å•æ–¹æ³•æ˜¯æŠ“å–<code>identifierComponents</code>æ•°ç»„ä¸­çš„æœ€åä¸€é¡¹å¹¶å°†å…¶åˆ†é…ç»™æ‚¨çš„è§†å›¾æ§åˆ¶å™¨ã€‚</p> <p>For objects that were created from your appâ€™s main storyboard file at launch time, do not create new instances of each object. Let UIKit find those objects implicitly or use the application:viewControllerWithRestorationIdentifierPath:coder: method of your app delegate to find the existing objects.</p> <p>å¯¹äºåœ¨å¯åŠ¨æ—¶ä»åº”ç”¨çš„ä¸»æ•…äº‹æ¿æ–‡ä»¶åˆ›å»ºçš„å¯¹è±¡ï¼Œä¸è¦ä¸ºæ¯ä¸ªå¯¹è±¡åˆ›å»ºæ–°å®ä¾‹ã€‚è®©UIKitéšå¼æŸ¥æ‰¾è¿™äº›å¯¹è±¡æˆ–ä½¿ç”¨åº”ç”¨å§”æ‰˜çš„<code>application:viewControllerWithRestorationIdentifierPath:coder:</code>æ–¹æ³•æ¥æŸ¥æ‰¾ç°æœ‰å¯¹è±¡ã€‚</p> <h3 id="å¯¹è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€è¿›è¡Œç¼–ç å’Œè§£ç -ğŸŸ-encoding-and-decoding-your-view-controller-s-state"><a href="#å¯¹è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€è¿›è¡Œç¼–ç å’Œè§£ç -ğŸŸ-encoding-and-decoding-your-view-controller-s-state" class="header-anchor">#</a> å¯¹è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€è¿›è¡Œç¼–ç å’Œè§£ç  ğŸŸ Encoding and Decoding Your View Controllerâ€™s State</h3> <p>For each object slated for preservation, UIKit calls the objectâ€™s encodeRestorableStateWithCoder: method to give it a chance to save its state. During the restoration process, UIKit calls the matching decodeRestorableStateWithCoder: method to decode that state and apply it to the object. The implementation of these methods is optional, but recommended, for your view controllers. You might use them to save and restore the following types of information:</p> <p>å¯¹äºæ¯ä¸ªé¢„å®šä¿å­˜çš„å¯¹è±¡ï¼ŒUIKitè°ƒç”¨å¯¹è±¡çš„<code>encodeRestorableStateWithCoder:</code>æ–¹æ³•ï¼Œè®©å®ƒæœ‰æœºä¼šä¿å­˜å…¶çŠ¶æ€ã€‚åœ¨æ¢å¤è¿‡ç¨‹ä¸­ï¼ŒUIKitè°ƒç”¨åŒ¹é…çš„<code>decodeRestorableStateWithCoder:</code>æ–¹æ³•æ¥è§£ç è¯¥çŠ¶æ€å¹¶å°†å…¶åº”ç”¨äºå¯¹è±¡ã€‚è¿™äº›æ–¹æ³•çš„å®ç°æ˜¯å¯é€‰çš„ï¼Œä½†å»ºè®®ç”¨äºæ‚¨çš„è§†å›¾æ§åˆ¶å™¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥ä¿å­˜å’Œæ¢å¤ä»¥ä¸‹ç±»å‹çš„ä¿¡æ¯ï¼š</p> <ul><li><p>References to any data being displayed (not the data itself)</p></li> <li><p>å¯¹æ­£åœ¨æ˜¾ç¤ºçš„æ•°æ®çš„å¼•ç”¨ï¼ˆä¸æ˜¯æ•°æ®æœ¬èº«ï¼‰</p></li> <li><p>For a container view controller, references to its child view controllers</p></li> <li><p>å¯¹äºå®¹å™¨è§†å›¾æ§åˆ¶å™¨ï¼Œå¯¹å…¶å­è§†å›¾æ§åˆ¶å™¨çš„å¼•ç”¨</p></li> <li><p>Information about the current selection</p></li> <li><p>æœ‰å…³å½“å‰é€‰æ‹©çš„ä¿¡æ¯</p></li> <li><p>For view controllers with a user-configurable view, information about the current configuration of that view.</p></li> <li><p>å¯¹äºå…·æœ‰ç”¨æˆ·å¯é…ç½®è§†å›¾çš„è§†å›¾æ§åˆ¶å™¨ï¼Œæœ‰å…³è¯¥è§†å›¾å½“å‰é…ç½®çš„ä¿¡æ¯ã€‚</p></li></ul> <p>In your encode and decode methods, you can encode objects and any data types supported by the coder. For all objects except views and view controllers, the object must adopt the NSCoding protocol and use the methods of that protocol to write its state. For views and view controllers, the coder does not use the NSCoding protocol to save the objectâ€™s state. Instead, the coder saves the restoration identifier of the object and adds it to the list of preservable objects, which causes that objectâ€™s encodeRestorableStateWithCoder: method to be called.</p> <p>åœ¨æ‚¨çš„ç¼–ç å’Œè§£ç æ–¹æ³•ä¸­ï¼Œæ‚¨å¯ä»¥å¯¹å¯¹è±¡å’Œç¼–ç å™¨æ”¯æŒçš„ä»»ä½•æ•°æ®ç±»å‹è¿›è¡Œç¼–ç ã€‚å¯¹äºé™¤è§†å›¾å’Œè§†å›¾æ§åˆ¶å™¨ä¹‹å¤–çš„æ‰€æœ‰å¯¹è±¡ï¼Œå¯¹è±¡å¿…é¡»é‡‡ç”¨<code>NSCoding</code>åè®®ï¼Œå¹¶ä½¿ç”¨è¯¥åè®®çš„æ–¹æ³•æ¥å†™å…¥å…¶çŠ¶æ€ã€‚å¯¹äºè§†å›¾å’Œè§†å›¾æ§åˆ¶å™¨ï¼Œç¼–ç å™¨ä¸ä½¿ç”¨<code>NSCoding</code>åè®®æ¥ä¿å­˜å¯¹è±¡çš„çŠ¶æ€ã€‚ç›¸åï¼Œç¼–ç å™¨ä¿å­˜å¯¹è±¡çš„<code>restoration identifier</code>å¹¶å°†å…¶æ·»åŠ åˆ°å¯ä¿å­˜å¯¹è±¡åˆ—è¡¨ä¸­ï¼Œè¿™ä¼šå¯¼è‡´è°ƒç”¨è¯¥å¯¹è±¡çš„<code>encodeRestorableStateWithCoder:</code>æ–¹æ³•ã€‚</p> <p>The encodeRestorableStateWithCoder: and decodeRestorableStateWithCoder: methods of your view controllers must call super at some point in their implementation. Calling super gives the parent class a chance to save and restore any additional information. Listing 7-2 shows a sample implementation of these methods that save a numerical value used to identify the specified view controller.</p> <p>è§†å›¾æ§åˆ¶å™¨çš„<code>encodeRestorableStateWithCoder:</code>å’Œ<code>decodeRestorableStateWithCoder:</code>æ–¹æ³•å¿…é¡»åœ¨å…¶å®ç°ä¸­çš„æŸä¸ªç‚¹è°ƒç”¨superã€‚è°ƒç”¨superä½¿çˆ¶ç±»æœ‰æœºä¼šä¿å­˜å’Œæ¢å¤ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚æ¸…å•7-2æ˜¾ç¤ºäº†è¿™äº›æ–¹æ³•çš„ç¤ºä¾‹å®ç°ï¼Œè¿™äº›æ–¹æ³•ä¿å­˜äº†ç”¨äºæ ‡è¯†æŒ‡å®šè§†å›¾æ§åˆ¶å™¨çš„æ•°å€¼ã€‚</p> <p>Listing 7-2Encoding and decoding a view controllerâ€™s state.</p> <p>æ¸…å•7-2 å¯¹è§†å›¾æ§åˆ¶å™¨çš„çŠ¶æ€è¿›è¡Œç¼–ç å’Œè§£ç ã€‚</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>encodeRestorableStateWithCoder<span class="token punctuation">:</span><span class="token punctuation">(</span>NSCoder <span class="token operator">*</span><span class="token punctuation">)</span>coder <span class="token punctuation">{</span>
   <span class="token punctuation">[</span><span class="token keyword">super</span> encodeRestorableStateWithCoder<span class="token punctuation">:</span>coder<span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token punctuation">[</span>coder encodeInt<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>number forKey<span class="token punctuation">:</span>MyViewControllerNumber<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>decodeRestorableStateWithCoder<span class="token punctuation">:</span><span class="token punctuation">(</span>NSCoder <span class="token operator">*</span><span class="token punctuation">)</span>coder <span class="token punctuation">{</span>
   <span class="token punctuation">[</span><span class="token keyword">super</span> decodeRestorableStateWithCoder<span class="token punctuation">:</span>coder<span class="token punctuation">]</span><span class="token punctuation">;</span>
 
   <span class="token keyword">self</span><span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token punctuation">[</span>coder decodeIntForKey<span class="token punctuation">:</span>MyViewControllerNumber<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Coder objects are not shared during the encode and decode process. Each object with preservable state receives its own coder object. The use of unique coders means that you do not have to worry about namespace collisions among your keys. However, do not use the UIApplicationStateRestorationBundleVersionKey, UIApplicationStateRestorationUserInterfaceIdiomKey, and UIStateRestorationViewControllerStoryboardKey key names yourself. Those keys are used by UIKit to store additional information about the state of your view controller.</p> <p>ç¼–ç å™¨å¯¹è±¡åœ¨ç¼–ç å’Œè§£ç è¿‡ç¨‹ä¸­ä¸å…±äº«ã€‚æ¯ä¸ªå…·æœ‰å¯ä¿å­˜çŠ¶æ€çš„å¯¹è±¡éƒ½æ¥æ”¶è‡ªå·±çš„ç¼–ç å™¨å¯¹è±¡ã€‚ä½¿ç”¨å”¯ä¸€çš„ç¼–ç å™¨æ„å‘³ç€æ‚¨ä¸å¿…æ‹…å¿ƒé”®ä¹‹é—´çš„å‘½åç©ºé—´å†²çªã€‚ä½†æ˜¯ï¼Œä¸è¦ä½¿ç”¨<code>UIApplicationStateRestorationBundleVersionKey</code>ã€<code>UIApplicationStateRestorationUserInterfaceIdiomKey</code>å’Œ<code>UIStateRestorationViewControllerStoryboardKey</code>é”®ã€‚UIKitä½¿ç”¨è¿™äº›é”®æ¥å­˜å‚¨æœ‰å…³è§†å›¾æ§åˆ¶å™¨çŠ¶æ€çš„å…¶ä»–ä¿¡æ¯ã€‚</p> <p>For more information about implementing the encode and decode methods for your view controllers, see UIViewController Class Reference.</p> <p>æœ‰å…³ä¸ºè§†å›¾æ§åˆ¶å™¨å®ç°ç¼–ç å’Œè§£ç æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…UIViewControllerç±»å‚è€ƒ<a href="https://developer.apple.com/documentation/uikit/uiviewcontroller" target="_blank" rel="noopener noreferrer">|åŸæ–‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="ä¿å­˜å’Œæ¢å¤è§†å›¾æ§åˆ¶å™¨çš„æç¤º-ğŸŸ-tips-for-saving-and-restoring-your-view-controllers"><a href="#ä¿å­˜å’Œæ¢å¤è§†å›¾æ§åˆ¶å™¨çš„æç¤º-ğŸŸ-tips-for-saving-and-restoring-your-view-controllers" class="header-anchor">#</a> ä¿å­˜å’Œæ¢å¤è§†å›¾æ§åˆ¶å™¨çš„æç¤º ğŸŸ Tips for Saving and Restoring Your View Controllers</h3> <p>As you add support for state preservation and restoration in your view controllers, consider the following guidelines:</p> <p>åœ¨è§†å›¾æ§åˆ¶å™¨ä¸­æ·»åŠ å¯¹çŠ¶æ€ä¿å­˜å’Œæ¢å¤çš„æ”¯æŒæ—¶ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹å‡†åˆ™ï¼š</p> <ul><li><p>Remember that you might not want to preserve all view controllers. In some cases, it might not make sense to preserve a view controller. For example, if the app was displaying a change, you might want to cancel the operation and restore the app to the previous screen. In such a case, you would not preserve the view controller that asks for the new password information.</p></li> <li><p><strong>è¯·è®°ä½ï¼Œæ‚¨å¯èƒ½ä¸æƒ³ä¿ç•™æ‰€æœ‰è§†å›¾æ§åˆ¶å™¨ã€‚</strong> åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¿ç•™è§†å›¾æ§åˆ¶å™¨å¯èƒ½æ²¡æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ˜¾ç¤ºæ›´æ”¹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å–æ¶ˆæ“ä½œå¹¶å°†åº”ç”¨ç¨‹åºæ¢å¤åˆ°ä¸Šä¸€ä¸ªå±å¹•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨ä¸ä¼šä¿ç•™è¯·æ±‚æ–°å¯†ç ä¿¡æ¯çš„è§†å›¾æ§åˆ¶å™¨ã€‚</p></li> <li><p>Avoid swapping view controller classes during the restoration process. The state preservation system encodes the class of the view controllers it preserves. During restoration, if your app returns an object whose class does not match (or is not a subclass of) the original object, the system does not ask the view controller to decode any state information. Thus, swapping out the old view controller for a completely different one does not restore the full state of the object.</p></li> <li><p><strong>é¿å…åœ¨æ¢å¤è¿‡ç¨‹ä¸­äº¤æ¢è§†å›¾æ§åˆ¶å™¨ç±»ã€‚</strong> çŠ¶æ€ä¿å­˜ç³»ç»Ÿå¯¹å…¶ä¿ç•™çš„è§†å›¾æ§åˆ¶å™¨ç±»è¿›è¡Œç¼–ç ã€‚åœ¨æ¢å¤è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºè¿”å›çš„å¯¹è±¡çš„ç±»ä¸åŸå§‹å¯¹è±¡ä¸åŒ¹é…ï¼ˆæˆ–ä¸æ˜¯åŸå§‹å¯¹è±¡çš„å­ç±»ï¼‰ï¼Œç³»ç»Ÿä¸ä¼šè¦æ±‚è§†å›¾æ§åˆ¶å™¨è§£ç ä»»ä½•çŠ¶æ€ä¿¡æ¯ã€‚å› æ­¤ï¼Œå°†æ—§è§†å›¾æ§åˆ¶å™¨æ¢æˆå®Œå…¨ä¸åŒçš„è§†å›¾æ§åˆ¶å™¨ä¸ä¼šæ¢å¤å¯¹è±¡çš„å®Œæ•´çŠ¶æ€ã€‚</p></li> <li><p>The state preservation system expects you to use view controllers as they were intended. The restoration process relies on the containment relationships of your view controllers to rebuild your interface. If you do not use container view controllers properly, the preservation system cannot find your view controllers. For example, never embed a view controllerâ€™s view inside a different view unless there is a containment relationship between the corresponding view controllers.</p></li> <li><p><strong>çŠ¶æ€ä¿å­˜ç³»ç»Ÿå¸Œæœ›æ‚¨æŒ‰é¢„æœŸä½¿ç”¨è§†å›¾æ§åˆ¶å™¨ã€‚</strong> æ¢å¤è¿‡ç¨‹ä¾èµ–äºè§†å›¾æ§åˆ¶å™¨çš„åŒ…å«å…³ç³»æ¥é‡å»ºæ‚¨çš„ç•Œé¢ã€‚å¦‚æœæ‚¨æ²¡æœ‰æ­£ç¡®ä½¿ç”¨å®¹å™¨è§†å›¾æ§åˆ¶å™¨ï¼Œä¿å­˜ç³»ç»Ÿå°†æ— æ³•æ‰¾åˆ°æ‚¨çš„è§†å›¾æ§åˆ¶å™¨ã€‚ä¾‹å¦‚ï¼Œé™¤éç›¸åº”çš„è§†å›¾æ§åˆ¶å™¨ä¹‹é—´å­˜åœ¨åŒ…å«å…³ç³»ï¼Œå¦åˆ™æ°¸è¿œä¸è¦å°†è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾åµŒå…¥åˆ°ä¸åŒçš„è§†å›¾ä¸­ã€‚</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/static_page/assets/js/app.ecc8d6d4.js" defer></script><script src="/static_page/assets/js/2.6f374f29.js" defer></script><script src="/static_page/assets/js/9.c45e563a.js" defer></script>
  </body>
</html>
